!function i(a,l,s){function u(t,e){if(!l[t]){if(!a[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(c)return c(t,!0);var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}var o=l[t]={exports:{}};a[t][0].call(o.exports,function(e){return u(a[t][1][e]||e)},o,o.exports,i,a,l,s)}return l[t].exports}for(var c="function"==typeof require&&require,e=0;e<s.length;e++)u(s[e]);return u}({1:[function(e,t,n){var r,o,i=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function l(){throw new Error("clearTimeout has not been defined")}function s(t){if(r===setTimeout)return setTimeout(t,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{o="function"==typeof clearTimeout?clearTimeout:l}catch(e){o=l}}();var u,c=[],f=!1,d=-1;function p(){f&&u&&(f=!1,u.length?c=u.concat(c):d=-1,c.length&&h())}function h(){if(!f){var e=s(p);f=!0;for(var t=c.length;t;){for(u=c,c=[];++d<t;)u&&u[d].run();d=-1,t=c.length}u=null,f=!1,function(t){if(o===clearTimeout)return clearTimeout(t);if((o===l||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(t);try{o(t)}catch(e){try{return o.call(null,t)}catch(e){return o.call(this,t)}}}(e)}}function v(e,t){this.fun=e,this.array=t}function g(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new v(e,t)),1!==c.length||f||s(h)},v.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();var r=function(){function r(e,t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.scriptLoaderService=e,this.$window=t,this.$http=n}return o(r,[{key:"$onInit",value:function(){return this.loadBadge().then(this.onLoad).catch(function(e){return console.log(e)})}},{key:"loadBadge",value:function(){var n=this;return new Promise(function(e,t){n.doi?n.$http.get("https://api.altmetric.com/v1/doi/"+n.doi).then(function(){try{n.loadBadgeScript()}catch(e){return console.log(e),void t("Altmetrics onLoad error.")}e()}).catch(function(e){return t("REX: Altmetrics badge cannot be loaded.")}):t("REX: Altmetrics badge cannot be loaded as no DOI is present.")})}},{key:"loadBadgeScript",value:function(){return this.scriptLoaderService.load("https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js")}},{key:"$onDestroy",value:function(){this.$window._altmetric&&delete this.$window._altmetric,this.scriptLoaderService.unload("https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js","js"),this.scriptLoaderService.unload("https://d1bxh8uas1mnw7.cloudfront.net/assets/altmetric_badges-8f271adb184c21cc5169a7f67f7fe5ab.js","js"),this.scriptLoaderService.unload("https://d1bxh8uas1mnw7.cloudfront.net/assets/embed-2c47105b6381604898bbf8ae8a680350.css","css"),console.log("REX: Altmetrics badge is destroyed!.")}}]),r}();r.$inject=["scriptLoaderService","$window","$http"];n.AltmetricsConfig={name:"rexAltmetrics",config:{template:'<div ng-if="$ctrl.doi" class="altmetric-embed" data-badge-type="medium-donut" data-badge-details="right" data-doi="{{$ctrl.doi}}"></div>',bindings:{doi:"<",onLoad:"&"},controller:r}}},{}],3:[function(e,t,n){"use strict";console.log("xxxx"),angular.module("angularLoadMonkeyPatched",[]).service("angularLoadMonkeyPatched",["$document","$q","$timeout",function(e,o,i){var r=e[0],a={};function t(r){return function(e){var t=o.defer(),n=r(e);return n.onload=n.onreadystatechange=function(e){n.readyState&&"complete"!==n.readyState&&"loaded"!==n.readyState||i(function(){t.resolve(e)})},n.onerror=function(e){i(function(){t.reject(e)})},a[e]=t.promise,a[e]}}this.loadScript=t(function(e){var t=r.createElement("script");return t.src=e,r.body.appendChild(t),t}),this.loadCSS=t(function(e){var t=r.createElement("link");return t.rel="stylesheet",t.type="text/css",t.href=e,r.head.appendChild(t),t}),this.unloadCSS=function(e){delete a[e];var t=r.head;if(t){var n=t.querySelector('[href="'+e+'"]');if(n)return n.remove(),!0}return!1}}])},{}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.AnnouncementService=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("./viewName");(n.AnnouncementService=function(){function o(e,t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),this.$translate=e,this.$mdToast=t,this.$rootScope=n,this._dismissed=!1,this.$rootScope.$on("$translateChangeSuccess",function(){r._dismissed=!1})}return r(o,[{key:"_dismiss",value:function(){this._dismissed=!0,this._toastPromise=null}},{key:"display",value:function(r){var o=this;return new Promise(function(t,n){!0!==o._dismissed?o.$translate("nui.message.announcement").then(function(e){if(!e||["announcement","&nbsp;",""].includes(e))return o._toastPromise&&!o._dismissed&&o.$mdToast.hide(),void n("No announcement found.");o._toastPromise=o._toastPromise||o.$mdToast.show({hideDelay:!1,position:"top",controller:function(){return{close:function(){o.$mdToast.hide()}}},controllerAs:"$ctrl",templateUrl:"custom/"+i.viewName+"/html/announcement.html"}),o._toastPromise.then(r).catch(r).then(function(){return o._dismiss()}),t()}):n("The announcement has been dismissed.")})}}]),o}()).$inject=["$translate","$mdToast","$rootScope"]},{"./viewName":27}],5:[function(e,t,n){},{}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();(n.GoogleAnalyticsService=function(){function r(e,t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.$rootScope=e,this.$location=t,this.$window=n}return o(r,[{key:"initialize",value:function(n){var r=this;return new Promise(function(e,t){r._loadGa(),r.$window.ga("create",n,"auto"),r.$window.ga("set","anonymizeIp",!0),e()})}},{key:"trackPageViews",value:function(){var t=this;t.$rootScope.$on("$locationChangeSuccess",function(e){t.$window.ga("send","pageview",{location:t.$location.url()})})}},{key:"_loadGa",value:function(){var e,t,n,r,o;e=this.$window,t=this.$window.document,n="ga",e.GoogleAnalyticsObject=n,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,r=t.createElement("script"),o=t.getElementsByTagName("script")[0],r.async=1,r.src="https://www.google-analytics.com/analytics.js",o.parentNode.insertBefore(r,o)}}]),r}()).$inject=["$rootScope","$location","$window"]},{}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();var o={name:"http://schema.org/name",description:"http://schema.org/description",altLabel:"http://www.w3.org/2004/02/skos/core#altLabel",sameAs:"http://schema.org/sameAs",pseudonym:"http://www.wikidata.org/prop/direct/P742",image:"http://www.wikidata.org/prop/direct/P18",usedLanguage:"http://www.wikidata.org/prop/direct/P1412",placeOfBirth:"http://www.wikidata.org/prop/direct/P19",placeOfDeath:"http://www.wikidata.org/prop/direct/P20",gender:"http://www.wikidata.org/prop/direct/P21",countryOfcitizenship:"http://www.wikidata.org/prop/direct/P27",nativeLanguage:"http://www.wikidata.org/prop/direct/P103",occupation:"http://www.wikidata.org/prop/direct/P106",dateOfBirth:"http://www.wikidata.org/prop/direct/P569",dateOfDeath:"http://www.wikidata.org/prop/direct/P570"};n.LinkedPerson=function(){function n(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.uri=e,this.data=t,this.targetProperties=o,this.mainResource=this.findInData(this.uri)}return r(n,[{key:"findInData",value:function(t){return this.data.find(function(e){return e["@id"]==t})}},{key:"getLocaleData",value:function(){var t=this,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"en",r={};return this.namesOfExistingProperties().forEach(function(e){r[e]=t.getPropertyInLocale(e,n)}),r=this.convertDates(r),this.cleanData(r)}},{key:"namesOfExistingProperties",value:function(){var n=this;return Object.keys(this.targetProperties).filter(function(e){var t=n.targetProperties[e];return n.mainResource[t]})}},{key:"convertDates",value:function(n){return["dateOfBirth","dateOfDeath"].filter(function(e){return n[e]}).forEach(function(e){var t=e[0];t&&(n[e][0]=new Date(t).getFullYear())}),n}},{key:"cleanData",value:function(n){return Object.keys(n).forEach(function(e){var t=n[e].filter(Boolean);0==t.length?delete n[e]:n[e]=t}),n}},{key:"getPropertyInLocale",value:function(e,t){var n=this.targetProperties[e];return this.transformValues(n,t)}},{key:"transformValues",value:function(e,t){var n=this;return this.mainResource[e].map(function(e){return n.transformValue(e,t)})}},{key:"transformValue",value:function(e,t){return e["@id"]?this.transformUriValue(e["@id"],t):this.transformLiteralValue(e,t)}},{key:"transformLiteralValue",value:function(e,t){return this.shouldLiteralValueStay(e,t)?e["@value"]:null}},{key:"shouldLiteralValueStay",value:function(e,t){return e["@type"]||e["@language"]==t}},{key:"transformUriValue",value:function(e,t){var n=this.findInData(e),r=void 0;return n&&(r=this.getNameInLocale(n,t)),r||e}},{key:"getNameInLocale",value:function(e,t){var n=this,r=e["http://schema.org/name"].find(function(e){return n.shouldLiteralValueStay(e,t)});return!!r&&r["@value"]}}]),n}()},{}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.LinkedPersonsConfig=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),o=e("./viewName");var i=function(){function n(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.linkedPersonsService=e,this.$mdDialog=t}return r(n,[{key:"$onInit",value:function(){this.persons=[],this.uris&&this.loadPersons().then(this.onLoad).catch(function(){console.log("Could not fetch data about the author.")})}},{key:"loadPersons",value:function(){var t=this;return this.linkedPersonsService.getMultiple(this.uris).then(function(e){t.persons=e})}}]),n}();i.$inject=["linkedPersonsService","$mdDialog"];n.LinkedPersonsConfig={name:"rexLinkedPersons",config:{bindings:{uris:"<",onLoad:"&"},controller:i,templateUrl:"custom/"+o.viewName+"/html/linkedPersons.component.html"}}},{"./viewName":27}],9:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.LinkedPersonsService=void 0;var r,o=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("jsonld"),a=(r=i)&&r.__esModule?r:{default:r},l=e("./linkedPerson");(n.LinkedPersonsService=function(){function n(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.$http=e,this.localeService=t,this.webServiceUrlBase="https://ec2-54-229-3-116.eu-west-1.compute.amazonaws.com/persons/",this.jsonld=a.default,this.persons={}}return o(n,[{key:"getMultiple",value:function(e){var t=this;return Promise.all(e.map(function(e){return t.get(e)}))}},{key:"get",value:function(e){return this.getForRelativeUri(this.relativeUri(e))}},{key:"relativeUri",value:function(e){return"?uri="+encodeURIComponent(e)}},{key:"getForRelativeUri",value:function(e){var t=this;return this.getData(e).then(function(e){return t.getLocaleData(e)})}},{key:"getLocaleData",value:function(e){var t=this.getLocaleId();return Promise.resolve(e.getLocaleData(t))}},{key:"getLocaleId",value:function(){return"da_DK"==this.localeService.current()?"da":"en"}},{key:"getData",value:function(e){var t=this.persons[e];return t?Promise.resolve(t):this.getAndSave(e)}},{key:"getAndSave",value:function(t){var n=this;return this.fetchAndFlatten(t).then(function(e){return n.save(t,e)})}},{key:"fetchAndFlatten",value:function(e){var t=this;return this.fetch(e).then(function(e){return t.flatten(e)})}},{key:"fetch",value:function(e){var r=this,o={method:"GET",url:this.targetUrl(e),headers:{Accept:"application/ld+json"}};return new Promise(function(t,n){r.$http(o).then(function(e){e.data?t(e.data):n("Received a blank response.")}).catch(n)})}},{key:"targetUrl",value:function(e){return this.webServiceUrlBase+e}},{key:"flatten",value:function(t){return new Promise(function(n,e){a.default.flatten(t,function(e,t){n(t)})})}},{key:"save",value:function(e,t){return this.persons[e]=new l.LinkedPerson(e,t)}}]),n}()).$inject=["$http","localeService"]},{"./linkedPerson":7,jsonld:30}],10:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();(n.LocaleService=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.$location=e}return r(t,[{key:"current",value:function(){return this.$location.search().lang}}]),t}()).$inject=["$location"]},{}],11:[function(e,t,n){"use strict";var r=e("./viewName"),o=e("./navigation.service"),i=e("./announcement.service"),a=e("./scriptLoader.service"),l=e("./pickUpNumbers.service"),s=e("./linkedPersons.service"),u=e("./googleAnalytics.service"),c=e("./locale.service"),f=e("./openingHours.component"),d=e("./searchTips.component"),p=e("./altmetrics.component"),h=e("./linkedPersons.component"),v=e("./prmFinesAfter.component"),g=e("./prmLogoAfter.component"),m=e("./prmTopbarAfter.component"),y=e("./prmSearchBarAfter.component"),b=e("./prmFullViewAfter.component"),w=e("./prmPersonalInfoAfter.component"),x=e("./prmRequestsAfter.component"),k=e("./prmRequestsOverviewAfter.component"),j=e("./prmRequestServicesAfter.component"),_=e("./prmExploreMainAfter.component");angular.module("viewCustom",["angularLoadMonkeyPatched","ngMaterial"]).run(["$rootScope",function(e){e.viewName=r.viewName}]).run(["googleAnalyticsService",function(e){e.initialize("UA-77177865-1").then(function(){return e.trackPageViews()}).catch(function(e){console.log("Google anayltics could not be initialized."),console.log(e)})}]),angular.module("viewCustom").service("navigationService",o.NavigationService).service("announcementService",i.AnnouncementService).service("scriptLoaderService",a.ScriptLoaderService).service("pickUpNumbersService",l.PickUpNumbersService).service("linkedPersonsService",s.LinkedPersonsService).service("googleAnalyticsService",u.GoogleAnalyticsService).service("localeService",c.LocaleService).component(f.OpeningHoursConfig.name,f.OpeningHoursConfig.config).component(d.SearchTipsConfig.name,d.SearchTipsConfig.config).component(p.AltmetricsConfig.name,p.AltmetricsConfig.config).component(h.LinkedPersonsConfig.name,h.LinkedPersonsConfig.config).component(v.PrmFinesAfterConfig.name,v.PrmFinesAfterConfig.config).component(g.PrmLogoAfterConfig.name,g.PrmLogoAfterConfig.config).component(m.PrmTopbarAfterConfig.name,m.PrmTopbarAfterConfig.config).component(y.PrmSearchBarAfterConfig.name,y.PrmSearchBarAfterConfig.config).component(b.PrmFullViewAfterConfig.name,b.PrmFullViewAfterConfig.config).component(w.PrmPersonalInfoAfterConfig.name,w.PrmPersonalInfoAfterConfig.config).component(x.PrmRequestsAfterConfig.name,x.PrmRequestsAfterConfig.config).component(k.PrmRequestsOverviewAfterConfig.name,k.PrmRequestsOverviewAfterConfig.config).component(j.PrmRequestServicesAfterConfig.name,j.PrmRequestServicesAfterConfig.config).component(_.PrmExploreMainAfterConfig.name,_.PrmExploreMainAfterConfig.config),e("./angularLoadMonkeyPatched"),e("./cookie")},{"./altmetrics.component":2,"./angularLoadMonkeyPatched":3,"./announcement.service":4,"./cookie":5,"./googleAnalytics.service":6,"./linkedPersons.component":8,"./linkedPersons.service":9,"./locale.service":10,"./navigation.service":12,"./openingHours.component":13,"./pickUpNumbers.service":14,"./prmExploreMainAfter.component":15,"./prmFinesAfter.component":16,"./prmFullViewAfter.component":17,"./prmLogoAfter.component":18,"./prmPersonalInfoAfter.component":19,"./prmRequestServicesAfter.component":20,"./prmRequestsAfter.component":21,"./prmRequestsOverviewAfter.component":22,"./prmSearchBarAfter.component":23,"./prmTopbarAfter.component":24,"./scriptLoader.service":25,"./searchTips.component":26,"./viewName":27}],12:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.NavigationService=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("./viewName");(n.NavigationService=function(){function n(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.$location=e,this.$window=t}return r(n,[{key:"navigateTo",value:function(e){void 0===e||""===e?this.navigateToHomePage():this.$window.open(e,"_blank")}},{key:"navigateToHomePage",value:function(){var e=this.$location.search(),t=e.vid||i.viewName,n=e.lang||"da_DK",r=this.$location.absUrl().split("/primo-explore/");if(1===r.length)return console.log("Could not process the URL : "+r[0]),!1;var o=r[0];return this.$window.location.href=o+"/primo-explore/search?vid="+t+"&lang="+n,!0}}]),n}()).$inject=["$location","$window"]},{"./viewName":27}],13:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();var r=function(){function r(e,t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.scriptLoaderService=e,this.localeService=n,this.$window=t}return o(r,[{key:"$onInit",value:function(){var t=this;this._danish_i18n={library:"Bibliotek",openHourToday:"Dagens Åbningstid",openHour:"Åbningstid",closed:"Lukket",allDay:"Døgnåbent",weekdays:["Mandag","Tirsdag","Onsdag","Torsdag","Fredag","Lørdag","Søndag"],weekdaysAbbr:["man","tirs","ons","tors","fre","lør","søn"],info:"Info",map:"Kort",allWeek:"Hele ugen",allLibraries:"Alle biblioteker","The Black Diamond - Reading Rooms":"Diamantens læsesale","Black Diamond - Reading Room West":"Diamanten - Læsesal Vest","KUB South Campus":"KUB Søndre Campus","RUb staffed hours":"RUb personlig betjening","Danish National Art Library - Nyhavn":"Danmarks Kunstbibliotek - Nyhavn","DKB Study Room":"DKB Studiesal Søborg",ampm:!1},this._english_i18n={library:"Library",openHourToday:"Open",openHour:"Opening hours",closed:"Closed",weekdays:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],weekdaysAbbr:["mon","tue","wed","thu","fri","sat","sun"],info:"Info",map:"Map",allWeek:"All Week",allLibraries:"All Libraries",byAppointment:"By appointment","Diamantens læsesale":"The Black Diamond - Reading Rooms","Den Sorte Diamant":"The Black Diamond","KUB Nord":"KUB North",ampm:!1},this.loadOpeningHoursWidget().catch(function(e){return console.log(e),t.loadOpeningHoursWidget()}).catch(function(e){return console.log(e),t.loadOpeningHoursWidget()}).catch(function(e){console.log(e)})}},{key:"$onDestroy",value:function(){this.unloadOpeningHoursWidget(),console.log("Opening hours widget destroyed!.")}},{key:"loadOpeningHoursWidget",value:function(){var r=this;return new Promise(function(t,n){r.scriptLoaderService.load("https://static.kb.dk/libcal/openingHours_min.js").then(function(){var e="da_DK"===r.localeService.current()?r._danish_i18n:r._english_i18n;if(r._openingHours=OpeningHours,!r._openingHours)throw"Opening hours widget could not be loaded!";r._openingHours.config={library:"all",timespan:"day",colorScheme:"standard03",allLibraryColor:"#6a6864",useLibraryColors:!0,i18n:e},r.scriptLoaderService.load("https://api3-eu.libcal.com/api_hours_grid.php?iid=1069&format=json&weeks=1&callback=OpeningHours.loadOpeningHours").then(t).catch(function(){return r.unloadOpeningHoursWidget(),n("Opening hours data could not be loaded!")})}).catch(function(){return r.unloadOpeningHoursWidget(),n("Opening hours widget could not be loaded!")})})}},{key:"unloadOpeningHoursWidget",value:function(){this.$window.loadAdditionalJavascript=void 0,this.$window.OpeningHours=void 0,delete this.$window.openingHours,delete this._openingHours;var e=this.$window.document.getElementById("openingHoursModalDiv");e&&(e.outerHTML=""),this.scriptLoaderService.unload("callback=OpeningHours.loadOpeningHours","js"),this.scriptLoaderService.unload("callback=OpeningHours.initializeGMaps","js"),this.scriptLoaderService.unload("openingHours_min.js","js"),this.scriptLoaderService.unload("openingHoursStyles_min.css","css")}}]),r}();r.$inject=["scriptLoaderService","$window","localeService"];n.OpeningHoursConfig={name:"rexOpeningHours",config:{template:'<div id="openingHoursContainer"></div>',bindings:{parentCtrl:"<"},controller:r}}},{}],14:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();(n.PickUpNumbersService=function(){function n(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.$http=e,this.$location=t,this._serviceBaseUrl="localhost"===this.$location.host()?"https://rex.kb.dk/cgi-bin/":this.$location.absUrl().split("/primo-explore/")[0]+"/cgi-bin/",this._pickUpNumbersForIds={},this._ongoingInsertions=0,this._runningPromise}return r(n,[{key:"waitForIdsAndInsertPickUpNumbers",value:function(n){var r=this;n.$scope.$watch(function(){return n.selector(n.parentElement).length},function(e,t){e&&e!==t&&r.insertPickUpNumbers(n.parentElement,n.parentCtrl.requestsService.requestsDisplay,n.selector)})}},{key:"insertPickUpNumbers",value:function(e,t,n){var r=this;return this._runningPromise?this._runningPromise.then(function(){return r._insert(e,t,n)}):this._insert(e,t,n)}},{key:"_insert",value:function(o,i,a){var e=this,l=this;return l._runningPromise=new Promise(function(t,e){var n=a(o),r=l._composeRequestObjects(n,i);l._ongoingInsertions=r.length,r.forEach(function(e){l._insertForRequest(e).then(function(){l._ongoingInsertions=l._ongoingInsertions-1,0!==l._ongoingInsertions||t()})})}),this._runningPromise.then(function(){e._runningPromise=null}),this._runningPromise}},{key:"_composeRequestObjects",value:function(n,e){return e.map(function(e){var t=e.requestId+"$";return{element:Array.prototype.find.call(n,function(e){return e.textContent.match(new RegExp(t))}),id:e.requestId,expandedDisplay:e.expandedDisplay}})}},{key:"_insertForRequest",value:function(r){var o=this;return new Promise(function(n,e){r.element?o._pickUpNumbersForIds[r.id]?(o._replaceIdText(r,o._pickUpNumbersForIds[r.id]),n()):r.expandedDisplay.find(function(e){return"request.holds.end_hold_date"===e.label})?o._retrievePickUpNumber(r.id).then(function(e){var t=e.data.split(/<body>|<\/body>/)[1];o._pickUpNumbersForIds[r.id]=t,o._replaceIdText(r,t),n()}).catch(function(){o._removeIdText(r),console.log("REX: Could not retrieve the pick up number."),n()}):(o._removeIdText(r),n()):n()})}},{key:"_removeIdText",value:function(e){this._replaceIdText(e,"")}},{key:"_retrievePickUpNumber",value:function(e){var t=this._serviceBaseUrl,n=e.match(/^TITLE([0-9]*)/);return n&&2===n.length?t+="get_pickup_number_title_kgl?z370_rec_key="+n[1]:t+="get_pickup_number_text?z37_rec_key="+e.slice(-19),this.$http.get(t)}},{key:"_replaceIdText",value:function(e,t){e.element.textContent=e.element.textContent.replace("-"+e.id,t)}}]),n}()).$inject=["$http","$location"]},{}],15:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.PrmExploreMainAfterConfig=void 0;var r=e("./viewName");n.PrmExploreMainAfterConfig={name:"prmExploreMainAfter",config:{templateUrl:"custom/"+r.viewName+"/html/prmExploreMainAfter.component.html"}}},{"./viewName":27}],16:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.PrmFinesAfterConfig=void 0;var r=e("./viewName");n.PrmFinesAfterConfig={name:"prmFinesAfter",config:{templateUrl:"custom/"+r.viewName+"/html/prmFinesAfter.component.html"}}},{"./viewName":27}],17:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.PrmFullViewAfterConfig=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),o=e("./viewName");var i=function(){function n(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.$element=e,this.$scope=t}return r(n,[{key:"$onInit",value:function(){this.parentElement=this.$element.parent()[0],this.retrieveDoiIfPresent(),this.retrieveViafIdsIfPresent()}},{key:"retrieveDoiIfPresent",value:function(){try{this.doi=this.parentCtrl.item.pnx.addata.doi[0]}catch(e){console.log("DOI not found.")}}},{key:"retrieveViafIdsIfPresent",value:function(){try{this.viafUris=this.parentCtrl.item.pnx.addata.lad06}catch(e){console.log("No VIAF URI found.")}}},{key:"insertAltmetricsSection",value:function(){var e=this.$element.find("rex-altmetrics")[0];this.insertSection({scrollId:"altmetrics",serviceName:"altmetrics",title:"brief.results.tabs.Altmetrics"},e)}},{key:"insertAuthorsSection",value:function(){var e=this.$element.find("rex-linked-persons")[0];this.insertSection({scrollId:"authors",serviceName:"authors",title:"brief.results.tabs.Authors"},e)}},{key:"insertSection",value:function(e,t){var n='h4[translate="'+e.title+'"]';this.waitForTargetThenMoveSection(n,t),this.insertSectionData(e)}},{key:"waitForTargetThenMoveSection",value:function(e,n){var r=this,o=this.$scope.$watch(function(){return r.parentElement.querySelector(e)},function(e,t){e&&(r.moveSectionElement(e,n),o())})}},{key:"moveSectionElement",value:function(e,t){var n=e.parentElement.parentElement.parentElement.parentElement.children[1];n&&n.appendChild&&n.appendChild(t)}},{key:"insertSectionData",value:function(e){this.parentCtrl.services.splice(this.parentCtrl.services.length-1,0,e)}}]),n}();i.$inject=["$element","$scope"];n.PrmFullViewAfterConfig={name:"prmFullViewAfter",config:{bindings:{parentCtrl:"<"},controller:i,templateUrl:"custom/"+o.viewName+"/html/prmFullViewAfter.component.html"}}},{"./viewName":27}],18:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.PrmLogoAfterConfig=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),o=e("./viewName");var i=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.navigationService=e}return r(t,[{key:"getIconLink",value:function(){return this.parentCtrl.iconLink}}]),t}();i.$inject=["navigationService"];n.PrmLogoAfterConfig={name:"prmLogoAfter",config:{bindings:{parentCtrl:"<"},controller:i,templateUrl:"custom/"+o.viewName+"/html/prmLogoAfter.component.html"}}},{"./viewName":27}],19:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();var o=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.navigationService=e}return r(t,[{key:"$onInit",value:function(){var e=this;this.parentCtrl.editDetails=function(){e.navigationService.navigateTo("https://user.kb.dk/user/edit")}}}]),t}();o.$inject=["navigationService"];n.PrmPersonalInfoAfterConfig={name:"prmPersonalInfoAfter",config:{bindings:{parentCtrl:"<"},controller:o}}},{}],20:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();var o=function(){function n(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.$scope=e,this.$element=t}return r(n,[{key:"$onInit",value:function(){var r=this;this.parentElement=this.$element.parent(),this.$scope.$watch(function(){return r.parentCtrl.isLoggedIn()&&r.parentElement[0].querySelector(".links-block-item prm-service-button button")},function(e,t){if(e&&!t){var n=r.parentElement[0].querySelectorAll(".links-block-item");2!=n.length&&console.log("An unhandled case is encountered in prm-request-services."),n[0].querySelector('span[translate="ILL"]')?r.parentElement.remove():(angular.element(n[0]).find("button").removeClass("button-as-link"),angular.element(n[0]).find("button").addClass("request-button"),n[1].remove())}})}}]),n}();o.$inject=["$scope","$element"];n.PrmRequestServicesAfterConfig={name:"prmRequestServicesAfter",config:{bindings:{parentCtrl:"<"},controller:o}}},{}],21:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();var r=function(){function r(e,t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.$scope=e,this.$element=t,this.pickUpNumbersService=n}return o(r,[{key:"$onInit",value:function(){this.parentElement=this.$element.parent()[0],this.pickUpNumbersService.waitForIdsAndInsertPickUpNumbers(this)}},{key:"selector",value:function(e){return e.querySelectorAll('p[ng-if="::requestDisplay.secondLineRight"]')}}]),r}();r.$inject=["$scope","$element","pickUpNumbersService"];n.PrmRequestsAfterConfig={name:"prmRequestsAfter",config:{bindings:{parentCtrl:"<"},controller:r}}},{}],22:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();var r=function(){function r(e,t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.$scope=e,this.$element=t,this.pickUpNumbersService=n}return o(r,[{key:"$onInit",value:function(){this.parentElement=this.$element.parent()[0],this.pickUpNumbersService.waitForIdsAndInsertPickUpNumbers(this)}},{key:"selector",value:function(e){return e.querySelectorAll('p[ng-if="::request.secondLineRight"] span')}}]),r}();r.$inject=["$scope","$element","pickUpNumbersService"];n.PrmRequestsOverviewAfterConfig={name:"prmRequestsOverviewAfter",config:{bindings:{parentCtrl:"<"},controller:r}}},{}],23:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.PrmSearchBarAfterConfig=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),o=e("./viewName");var i=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.$element=e}return r(t,[{key:"$postLink",value:function(){var e=this.$element.parent();angular.element(e.children()[0].children[0]).append(this.$element.children()[0]);var t=e[0].querySelector("#searchBar");t&&t.focus()}}]),t}();i.$inject=["$element"];n.PrmSearchBarAfterConfig={name:"prmSearchBarAfter",config:{templateUrl:"custom/"+o.viewName+"/html/prmSearchBarAfter.component.html",controller:i}}},{"./viewName":27}],24:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();var o=function(){function o(e,t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),this.announcementService=e,this.$scope=t,this.$element=n,this.$translate=r}return r(o,[{key:"$onInit",value:function(){var n=this;this.announcementService.display(function(){return n.hideCallback()}).then(function(){return n.displayCallback()}).catch(function(e){e&&console.log(e)});var r=this.$element.parent()[0].getElementsByClassName("user-name");this.$scope.$watch(r.length,function(e,t){Array.prototype.forEach.call(r,function(t){n.primoExploreCtrl.userSessionManagerService.isGuest()&&n.$translate("eshelf.signin.title").then(function(e){t.textContent=e})})})}},{key:"displayCallback",value:function(){this.$element.parent().addClass("shifted-topbar")}},{key:"hideCallback",value:function(){this.$element.parent().removeClass("shifted-topbar")}}]),o}();o.$inject=["announcementService","$scope","$element","$translate"];n.PrmTopbarAfterConfig={name:"prmTopbarAfter",config:{controller:o,require:{primoExploreCtrl:"^primoExplore"}}}},{}],25:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();(n.ScriptLoaderService=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.angularLoadMonkeyPatched=e}return r(t,[{key:"load",value:function(e){return this.angularLoadMonkeyPatched.loadScript(e)}},{key:"unload",value:function(e,t){for(var n="js"==t?"script":"css"==t?"link":"none",r="js"==t?"src":"css"==t?"href":"none",o=document.getElementsByTagName(n),i=o.length;0<=i;i--)o[i]&&null!=o[i].getAttribute(r)&&-1!=o[i].getAttribute(r).indexOf(e)&&o[i].parentNode.removeChild(o[i])}}]),t}()).$inject=["angularLoadMonkeyPatched"]},{}],26:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SearchTipsConfig=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),o=e("./viewName");var i=function(){function n(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.$mdDialog=e,this.localeService=t}return r(n,[{key:"showSearchTips",value:function(e){var t=this;this.$mdDialog.show({controller:function(){return{hide:function(){t.$mdDialog.hide()},cancel:function(){t.$mdDialog.cancel()}}},controllerAs:"$ctrl",templateUrl:"custom/"+o.viewName+"/html/searchTips_"+this.localeService.current()+".html",parent:angular.element(document.body),targetEvent:e,clickOutsideToClose:!0,fullscreen:!1})}}]),n}();i.$inject=["$mdDialog","localeService"];n.SearchTipsConfig={name:"rexSearchTips",config:{controller:i,templateUrl:"custom/"+o.viewName+"/html/searchTips.component.html"}}},{"./viewName":27}],27:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.viewName="NUI"},{}],28:[function(W,X,e){(function(z,G){(function(){"use strict";function u(e){return"function"==typeof e}var t,n,a=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},r=0,l=function(e,t){b[r]=e,b[r+1]=t,2===(r+=2)&&(n?n(w):d())};var e="undefined"!=typeof window?window:void 0,o=e||{},i=o.MutationObserver||o.WebKitMutationObserver,s=void 0!==z&&"[object process]"==={}.toString.call(z),c="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function f(){return function(){setTimeout(w,1)}}var d,p,h,v,g,m,y,b=new Array(1e3);function w(){for(var e=0;e<r;e+=2){(0,b[e])(b[e+1]),b[e]=void 0,b[e+1]=void 0}r=0}function x(){}s?(m=z.nextTick,y=z.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/),Array.isArray(y)&&"0"===y[1]&&"10"===y[2]&&(m=setImmediate),d=function(){m(w)}):i?(h=0,v=new i(w),g=document.createTextNode(""),v.observe(g,{characterData:!0}),d=function(){g.data=h=++h%2}):c?((p=new MessageChannel).port1.onmessage=w,d=function(){p.port2.postMessage(0)}):d=void 0===e&&"function"==typeof W?function(){try{var e=W("vertx");return t=e.runOnLoop||e.runOnContext,function(){t(w)}}catch(e){return f()}}():f();var k=void 0,j=1,_=2,S=new N;function I(e,t){if(t.constructor===e.constructor)i=e,(a=t)._state===j?C(i,a._result):a._state===_?E(i,a._result):A(a,void 0,function(e){L(i,e)},function(e){E(i,e)});else{var n=function(e){try{return e.then}catch(e){return S.error=e,S}}(t);n===S?E(e,S.error):void 0===n?C(e,t):u(n)?(r=t,o=n,l(function(t){var n=!1,e=function(e,t,n,r){try{e.call(t,n,r)}catch(e){return e}}(o,r,function(e){n||(n=!0,r!==e?L(t,e):C(t,e))},function(e){n||(n=!0,E(t,e))},t._label);!n&&e&&(n=!0,E(t,e))},e)):C(e,t)}var r,o,i,a}function L(e,t){var n;e===t?E(e,new TypeError("You cannot resolve a promise with itself")):"function"==typeof(n=t)||"object"==typeof n&&null!==n?I(e,t):C(e,t)}function O(e){e._onerror&&e._onerror(e._result),P(e)}function C(e,t){e._state===k&&(e._result=t,e._state=j,0!==e._subscribers.length&&l(P,e))}function E(e,t){e._state===k&&(e._state=_,e._result=t,l(O,e))}function A(e,t,n,r){var o=e._subscribers,i=o.length;e._onerror=null,o[i]=t,o[i+j]=n,o[i+_]=r,0===i&&e._state&&l(P,e)}function P(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r,o,i=e._result,a=0;a<t.length;a+=3)r=t[a],o=t[a+n],r?T(n,r,o,i):o(i);e._subscribers.length=0}}function N(){this.error=null}var D=new N;function T(e,t,n,r){var o,i,a,l,s=u(n);if(s){if((o=function(e,t){try{return e(t)}catch(e){return D.error=e,D}}(n,r))===D?(l=!0,i=o.error,o=null):a=!0,t===o)return void E(t,new TypeError("A promises callback cannot return that same promise."))}else o=r,a=!0;t._state!==k||(s&&a?L(t,o):l?E(t,i):e===j?C(t,o):e===_&&E(t,o))}function R(e,t){var n=this;n._instanceConstructor=e,n.promise=new e(x),n._validateInput(t)?(n._input=t,n.length=t.length,n._remaining=t.length,n._init(),0===n.length?C(n.promise,n._result):(n.length=n.length||0,n._enumerate(),0===n._remaining&&C(n.promise,n._result))):E(n.promise,n._validationError())}R.prototype._validateInput=function(e){return a(e)},R.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},R.prototype._init=function(){this._result=new Array(this.length)};var U=R;R.prototype._enumerate=function(){for(var e=this.length,t=this.promise,n=this._input,r=0;t._state===k&&r<e;r++)this._eachEntry(n[r],r)},R.prototype._eachEntry=function(e,t){var n,r=this,o=r._instanceConstructor;"object"==typeof(n=e)&&null!==n?e.constructor===o&&e._state!==k?(e._onerror=null,r._settledAt(e._state,t,e._result)):r._willSettleAt(o.resolve(e),t):(r._remaining--,r._result[t]=e)},R.prototype._settledAt=function(e,t,n){var r=this,o=r.promise;o._state===k&&(r._remaining--,e===_?E(o,n):r._result[t]=n),0===r._remaining&&C(o,r._result)},R.prototype._willSettleAt=function(e,t){var n=this;A(e,void 0,function(e){n._settledAt(j,t,e)},function(e){n._settledAt(_,t,e)})};var $=function(e){var t=new this(x);if(!a(e))return E(t,new TypeError("You must pass an array to race.")),t;var n=e.length;function r(e){L(t,e)}function o(e){E(t,e)}for(var i=0;t._state===k&&i<n;i++)A(this.resolve(e[i]),void 0,r,o);return t};var q=function(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(x);return L(t,e),t};var M=function(e){var t=new this(x);return E(t,e),t},F=0;var B=V;function V(e){this._id=F++,this._state=void 0,this._result=void 0,this._subscribers=[],x!==e&&(u(e)||function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof V||function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}(),function(t,e){try{e(function(e){L(t,e)},function(e){E(t,e)})}catch(e){E(t,e)}}(this,e))}V.all=function(e){return new U(this,e).promise},V.race=$,V.resolve=q,V.reject=M,V._setScheduler=function(e){n=e},V._setAsap=function(e){l=e},V._asap=l,V.prototype={constructor:V,then:function(e,t){var n=this._state;if(n===j&&!e||n===_&&!t)return this;var r=new this.constructor(x),o=this._result;if(n){var i=arguments[n-1];l(function(){T(n,r,i,o)})}else A(this,r,e,t);return r},catch:function(e){return this.then(null,e)}};var H=function(){var e;if(void 0!==G)e=G;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;t&&"[object Promise]"===Object.prototype.toString.call(t.resolve())&&!t.cast||(e.Promise=B)},J={Promise:B,polyfill:H};"function"==typeof define&&define.amd?define(function(){return J}):void 0!==X&&X.exports?X.exports=J:void 0!==this&&(this.ES6Promise=J),H()}).call(this)}).call(this,W("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:1}],29:[function(e,t,n){},{}],30:[function(Se,n,e){(function(ke,je,_e){!function(){var we=void 0!==ke&&ke.versions&&ke.versions.node,xe=!we&&("undefined"!=typeof window||"undefined"!=typeof self);xe&&void 0===je&&("undefined"!=typeof window?je=window:"undefined"!=typeof self?je=self:"undefined"!=typeof $&&(je=$));var e=function(D){function e(){}D.compact=function(e,c,o,f){if(arguments.length<2)return D.nextTick(function(){f(new TypeError("Could not compact, too few arguments."))});if("function"==typeof o&&(f=o,o={}),o=o||{},null===c)return D.nextTick(function(){f(new O("The compaction context must not be null.","jsonld.CompactError",{code:"invalid local context"}))});if(null===e)return D.nextTick(function(){f(null,null)});"base"in o||(o.base="string"==typeof e?e:""),"compactArrays"in o||(o.compactArrays=!0),"graph"in o||(o.graph=!1),"skipExpansion"in o||(o.skipExpansion=!1),"documentLoader"in o||(o.documentLoader=D.loadDocument),"link"in o||(o.link=!1),o.link&&(o.skipExpansion=!0);!function(e,t,n){if(t.skipExpansion)return D.nextTick(function(){n(null,e)});D.expand(e,t,n)}(e,o,function(e,r){if(e)return f(new O("Could not expand input before compaction.","jsonld.CompactError",{cause:e}));var t=W(o);D.processContext(t,c,o,function(e,t){if(e)return f(new O("Could not process context before compaction.","jsonld.CompactError",{cause:e}));var n;try{n=(new d).compact(t,null,r,o)}catch(e){return f(e)}!function(e,t,n,r){if(e)return f(e);r.compactArrays&&!r.graph&&K(t)?1===t.length?t=t[0]:0===t.length&&(t={}):r.graph&&Q(t)&&(t=[t]);Q(c)&&"@context"in c&&(c=c["@context"]);K(c=ue(c))||(c=[c]);var o=c;c=[];for(var i=0;i<o.length;++i)(!Q(o[i])||0<Object.keys(o[i]).length)&&c.push(o[i]);var a=0<c.length;1===c.length&&(c=c[0]);if(K(t)){var l=J(n,"@graph"),s=t;t={},a&&(t["@context"]=c),t[l]=s}else if(Q(t)&&a){var s=t;for(var u in t={"@context":c},s)t[u]=s[u]}f(null,t,n)}(null,n,t,o)})})},D.expand=function(n,l,s){if(arguments.length<1)return D.nextTick(function(){s(new TypeError("Could not expand, too few arguments."))});function r(e){"base"in l||(l.base=e.documentUrl||"");var t={document:ue(e.document),remoteContext:{"@context":e.contextUrl}};if("expandContext"in l){var n=ue(l.expandContext);t.expandContext="object"==typeof n&&"@context"in n?n:{"@context":n}}fe(t,l,function(e,t){if(e)return s(e);var n;try{var r=new d,o=W(l),i=t.document,a=t.remoteContext["@context"];t.expandContext&&(o=r.processContext(o,t.expandContext["@context"],l)),a&&(o=r.processContext(o,a,l)),Q(n=r.expand(o,null,i,l,!1))&&"@graph"in n&&1===Object.keys(n).length?n=n["@graph"]:null===n&&(n=[]),K(n)||(n=[n])}catch(e){return s(e)}s(null,n)})}"function"==typeof l&&(s=l,l={}),"documentLoader"in(l=l||{})||(l.documentLoader=D.loadDocument),"keepFreeFloatingNodes"in l||(l.keepFreeFloatingNodes=!1),D.nextTick(function(){if("string"!=typeof n)r({contextUrl:null,documentUrl:null,document:n});else{var e=function(e,t){if(e)return s(e);try{if(!t.document)throw new O("No remote document found at the given URL.","jsonld.NullRemoteDocument");"string"==typeof t.document&&(t.document=JSON.parse(t.document))}catch(e){return s(new O("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",cause:e,remoteDoc:t}))}r(t)},t=l.documentLoader(n,e);t&&"then"in t&&t.then(e.bind(null,null),e)}})},D.flatten=function(e,r,o,i){if(arguments.length<1)return D.nextTick(function(){i(new TypeError("Could not flatten, too few arguments."))});"function"==typeof o?(i=o,o={}):"function"==typeof r&&(i=r,r=null,o={}),"base"in(o=o||{})||(o.base="string"==typeof e?e:""),"documentLoader"in o||(o.documentLoader=D.loadDocument),D.expand(e,o,function(e,t){if(e)return i(new O("Could not expand input before flattening.","jsonld.FlattenError",{cause:e}));var n;try{n=(new d).flatten(t)}catch(e){return i(e)}if(null===r)return i(null,n);o.graph=!0,o.skipExpansion=!0,D.compact(n,r,o,function(e,t){if(e)return i(new O("Could not compact flattened output.","jsonld.FlattenError",{cause:e}));i(null,t)})})},D.frame=function(n,r,a,l){if(arguments.length<2)return D.nextTick(function(){l(new TypeError("Could not frame, too few arguments."))});function o(e){var i,t=e.document;t?(i=t["@context"],e.contextUrl?(i?K(i)?i.push(e.contextUrl):i=[i,e.contextUrl]:i=e.contextUrl,t["@context"]=i):i=i||{}):i={},D.expand(n,a,function(e,r){if(e)return l(new O("Could not expand input before framing.","jsonld.FrameError",{cause:e}));var o=ue(a);o.isFrame=!0,o.keepFreeFloatingNodes=!0,D.expand(t,o,function(e,t){if(e)return l(new O("Could not expand frame before framing.","jsonld.FrameError",{cause:e}));var n;try{n=(new d).frame(r,t,o)}catch(e){return l(e)}o.graph=!0,o.skipExpansion=!0,o.link={},D.compact(n,i,o,function(e,t,n){if(e)return l(new O("Could not compact framed output.","jsonld.FrameError",{cause:e}));var r=J(n,"@graph");o.link={},t[r]=function e(t,n,r){if(K(n)){for(var o=[],i=0;i<n.length;++i){var a=e(t,n[i],r);null!==a&&o.push(a)}n=o}else if(Q(n)){if("@preserve"in n)return"@null"===n["@preserve"]?null:n["@preserve"];if(ie(n))return n;if(ae(n))return n["@list"]=e(t,n["@list"],r),n;var l=J(t,"@id");if(l in n){var s=n[l];if(s in r.link){var u=r.link[s].indexOf(n);if(-1!==u)return r.link[s][u];r.link[s].push(n)}else r.link[s]=[n]}for(var c in n){var a=e(t,n[c],r),f=D.getContextValue(t,c,"@container");r.compactArrays&&K(a)&&1===a.length&&null===f&&(a=a[0]),n[c]=a}}return n}(n,t[r],o),l(null,t)})})})}"function"==typeof a&&(l=a,a={}),"base"in(a=a||{})||(a.base="string"==typeof n?n:""),"documentLoader"in a||(a.documentLoader=D.loadDocument),"embed"in a||(a.embed="@last"),a.explicit=a.explicit||!1,"requireAll"in a||(a.requireAll=!0),a.omitDefault=a.omitDefault||!1,D.nextTick(function(){if("string"!=typeof r)o({contextUrl:null,documentUrl:null,document:r});else{var e=function(e,t){if(e)return l(e);try{if(!t.document)throw new O("No remote document found at the given URL.","jsonld.NullRemoteDocument");"string"==typeof t.document&&(t.document=JSON.parse(t.document))}catch(e){return l(new O("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",cause:e,remoteDoc:t}))}o(t)},t=a.documentLoader(r,e);t&&"then"in t&&t.then(e.bind(null,null),e)}})},D.link=function(e,t,n,r){var o={};t&&(o["@context"]=t),o["@embed"]="@link",D.frame(e,o,n,r)},D.objectify=function(e,r,o,i){"function"==typeof o&&(i=o,o={}),"base"in(o=o||{})||(o.base="string"==typeof e?e:""),"documentLoader"in o||(o.documentLoader=D.loadDocument),D.expand(e,o,function(e,t){if(e)return i(new O("Could not expand input before linking.","jsonld.LinkError",{cause:e}));var n;try{n=(new d).flatten(t)}catch(e){return i(e)}o.graph=!0,o.skipExpansion=!0,D.compact(n,r,o,function(e,t,a){if(e)return i(new O("Could not compact flattened output before linking.","jsonld.LinkError",{cause:e}));var l=t[J(a,"@graph")][0],s=function(e){if(Q(e)||K(e)){if(Q(e)){if(s.visited[e["@id"]])return;s.visited[e["@id"]]=!0}for(var t in e){var n=e[t],r="@id"===D.getContextValue(a,t,"@type");if(K(n)||Q(n)||r)if(Z(n)&&r)e[t]=n=l[n],s(n);else if(K(n))for(var o=0;o<n.length;++o)Z(n[o])&&r?n[o]=l[n[o]]:Q(n[o])&&"@id"in n[o]&&(n[o]=l[n[o]["@id"]]),s(n[o]);else if(Q(n)){var i=n["@id"];e[t]=n=l[i],s(n)}}}};for(var n in s.visited={},s(l),t.of_type={},l)if("@type"in l[n]){var r=l[n]["@type"];K(r)||(r=[r]);for(var o=0;o<r.length;++o)r[o]in t.of_type||(t.of_type[r[o]]=[]),t.of_type[r[o]].push(l[n])}i(null,t)})})},D.normalize=function(e,n,r){if(arguments.length<1)return D.nextTick(function(){r(new TypeError("Could not normalize, too few arguments."))});if("function"==typeof n&&(r=n,n={}),"algorithm"in(n=n||{})||(n.algorithm="URGNA2012"),"base"in n||(n.base="string"==typeof e?e:""),"documentLoader"in n||(n.documentLoader=D.loadDocument),"inputFormat"in n){if("application/nquads"!==n.inputFormat)return r(new O("Unknown normalization input format.","jsonld.NormalizeError"));var t=de(e);(new d).normalize(t,n,r)}else{var o=ue(n);delete o.format,o.produceGeneralizedRdf=!1,D.toRDF(e,o,function(e,t){if(e)return r(new O("Could not convert input to RDF dataset before normalization.","jsonld.NormalizeError",{cause:e}));(new d).normalize(t,n,r)})}},D.fromRDF=function(t,o,i){if(arguments.length<1)return D.nextTick(function(){i(new TypeError("Could not convert from RDF, too few arguments."))});"function"==typeof o&&(i=o,o={}),"useRdfType"in(o=o||{})||(o.useRdfType=!1),"useNativeTypes"in o||(o.useNativeTypes=!1),"format"in o||!Z(t)||"format"in o||(o.format="application/nquads"),D.nextTick(function(){var e;if(o.format){if(!(e=o.rdfParser||a[o.format]))return i(new O("Unknown input format.","jsonld.UnknownFormat",{format:o.format}))}else e=function(){return t};var n=!1;try{t=e(t,function(e,t){if(n=!0,e)return i(e);r(t,o,i)})}catch(e){if(!n)return i(e);throw e}if(t){if("then"in t)return t.then(function(e){r(e,o,i)},i);r(t,o,i)}function r(e,t,n){(new d).fromRDF(e,t,n)}})},D.toRDF=function(e,r,o){if(arguments.length<1)return D.nextTick(function(){o(new TypeError("Could not convert to RDF, too few arguments."))});"function"==typeof r&&(o=r,r={}),"base"in(r=r||{})||(r.base="string"==typeof e?e:""),"documentLoader"in r||(r.documentLoader=D.loadDocument),D.expand(e,r,function(e,t){if(e)return o(new O("Could not expand input before serialization to RDF.","jsonld.RdfError",{cause:e}));var n;try{if(n=d.prototype.toRDF(t,r),r.format){if("application/nquads"===r.format)return o(null,function(e){var t=[];for(var n in e)for(var r=e[n],o=0;o<r.length;++o){var i=r[o];"@default"===n&&(n=null),t.push(pe(i,n))}return t.sort().join("")}(n));throw new O("Unknown output format.","jsonld.UnknownFormat",{format:r.format})}}catch(e){return o(e)}o(null,n)})},D.createNodeMap=function(e,r,o){if(arguments.length<1)return D.nextTick(function(){o(new TypeError("Could not create node map, too few arguments."))});"function"==typeof r&&(o=r,r={}),"base"in(r=r||{})||(r.base="string"==typeof e?e:""),"documentLoader"in r||(r.documentLoader=D.loadDocument),D.expand(e,r,function(e,t){if(e)return o(new O("Could not expand input before creating node map.","jsonld.CreateNodeMapError",{cause:e}));var n;try{n=(new d).createNodeMap(t,r)}catch(e){return o(e)}o(null,n)})},D.merge=function(e,g,m,y){if(arguments.length<1)return D.nextTick(function(){y(new TypeError("Could not merge, too few arguments."))});if(!K(e))return D.nextTick(function(){y(new TypeError('Could not merge, "docs" must be an array.'))});"function"==typeof m?(y=m,m={}):"function"==typeof g&&(y=g,g=null,m={}),m=m||{};for(var n=[],r=null,o=e.length,t=0;t<e.length;++t){var i={};for(var a in m)i[a]=m[a];D.expand(e[t],i,l)}function l(e,t){if(!r){if(e)return y(new O("Could not expand input before flattening.","jsonld.FlattenError",{cause:r=e}));n.push(t),0==--o&&function(e){var t=!0;"mergeNodes"in m&&(t=m.mergeNodes);var n,r=m.namer||m.issuer||new he("_:b"),o={"@default":{}};try{for(var i=0;i<e.length;++i){var a=e[i];a=D.relabelBlankNodes(a,{issuer:new he("_:b"+i+"-")});var l=t||0===i?o:{"@default":{}};if(E(a,l,"@default",r),l!==o)for(var s in l){var u=l[s];if(s in o){var c=o[s];for(var f in u)f in c||(c[f]=u[f])}else o[s]=u}}n=A(o)}catch(e){return y(e)}for(var d=[],p=Object.keys(n).sort(),h=0;h<p.length;++h){var v=n[p[h]];oe(v)||d.push(v)}if(null===g)return y(null,d);m.graph=!0,m.skipExpansion=!0,D.compact(d,g,m,function(e,t){if(e)return y(new O("Could not compact merged output.","jsonld.MergeError",{cause:e}));y(null,t)})}(n)}}},D.relabelBlankNodes=function(e,t){return function e(t,n){if(K(n))for(var r=0;r<n.length;++r)n[r]=e(t,n[r]);else if(ae(n))n["@list"]=e(t,n["@list"]);else if(Q(n)){le(n)&&(n["@id"]=t.getId(n["@id"]));for(var o=Object.keys(n).sort(),i=0;i<o.length;++i){var a=o[i];"@id"!==a&&(n[a]=e(t,n[a]))}}return n}((t=t||{}).namer||t.issuer||new he("_:b"),e)},D.prependBase=function(e,t){return function(e,t){if(null===e)return t;if(-1!==t.indexOf(":"))return t;Z(e)&&(e=D.url.parse(e||""));var n=D.url.parse(t),r={protocol:e.protocol||""};if(null!==n.authority)r.authority=n.authority,r.path=n.path,r.query=n.query;else if(r.authority=e.authority,""===n.path)r.path=e.path,null!==n.query?r.query=n.query:r.query=e.query;else{if(0===n.path.indexOf("/"))r.path=n.path;else{var o=e.path;""!==n.path&&(0<(o=o.substr(0,o.lastIndexOf("/")+1)).length&&"/"!==o.substr(-1)&&(o+="/"),o+=n.path),r.path=o}r.query=n.query}r.path=ye(r.path,!!r.authority);var i=r.protocol;null!==r.authority&&(i+="//"+r.authority);i+=r.path,null!==r.query&&(i+="?"+r.query);null!==n.fragment&&(i+="#"+n.fragment);""===i&&(i="./");return i}(e,t)},D.documentLoader=function(e,t){var n=new O("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed"});return we?t(n,{contextUrl:null,documentUrl:e,document:null}):D.promisify(function(e){e(n)})},D.loadDocument=function(e,t){var n=D.documentLoader(e,t);n&&"then"in n&&n.then(t.bind(null,null),t)},D.promises=function(e){e=e||{};var n=Array.prototype.slice,r=D.promisify,t=e.api||{},o=e.version||"jsonld.js";"string"==typeof e.api&&(e.version||(o=e.api),t={}),t.expand=function(e){if(arguments.length<1)throw new TypeError("Could not expand, too few arguments.");return r.apply(null,[D.expand].concat(n.call(arguments)))},t.compact=function(e,t){if(arguments.length<2)throw new TypeError("Could not compact, too few arguments.");return r.apply(null,[function(e,t,n,r){"function"==typeof n&&(r=n,n={}),n=n||{},D.compact(e,t,n,function(e,t){r(e,t)})}].concat(n.call(arguments)))},t.flatten=function(e){if(arguments.length<1)throw new TypeError("Could not flatten, too few arguments.");return r.apply(null,[D.flatten].concat(n.call(arguments)))},t.frame=function(e,t){if(arguments.length<2)throw new TypeError("Could not frame, too few arguments.");return r.apply(null,[D.frame].concat(n.call(arguments)))},t.fromRDF=function(e){if(arguments.length<1)throw new TypeError("Could not convert from RDF, too few arguments.");return r.apply(null,[D.fromRDF].concat(n.call(arguments)))},t.toRDF=function(e){if(arguments.length<1)throw new TypeError("Could not convert to RDF, too few arguments.");return r.apply(null,[D.toRDF].concat(n.call(arguments)))},t.normalize=function(e){if(arguments.length<1)throw new TypeError("Could not normalize, too few arguments.");return r.apply(null,[D.normalize].concat(n.call(arguments)))},"jsonld.js"===o&&(t.link=function(e,t){if(arguments.length<2)throw new TypeError("Could not link, too few arguments.");return r.apply(null,[D.link].concat(n.call(arguments)))},t.objectify=function(e){return r.apply(null,[D.objectify].concat(n.call(arguments)))},t.createNodeMap=function(e){return r.apply(null,[D.createNodeMap].concat(n.call(arguments)))},t.merge=function(e){return r.apply(null,[D.merge].concat(n.call(arguments)))});try{D.Promise=je.Promise||Se("es6-promise").Promise}catch(e){var i=function(){throw new Error("Unable to find a Promise implementation.")};for(var a in t)t[a]=i}return t},D.promisify=function(e){if(!D.Promise)try{D.Promise=je.Promise||Se("es6-promise").Promise}catch(e){throw new Error("Unable to find a Promise implementation.")}var t=Array.prototype.slice.call(arguments,1);return new D.Promise(function(n,r){e.apply(null,t.concat(function(e,t){e?r(e):n(t)}))})},D.promises({api:D.promises}),(e.prototype=D.promises({version:"json-ld-1.0"})).toString=function(){return this instanceof e?"[object JsonLdProcessor]":"[object JsonLdProcessorPrototype]"},D.JsonLdProcessor=e;var t=!!Object.defineProperty;if(t)try{Object.defineProperty({},"x",{})}catch(e){t=!1}t&&(Object.defineProperty(e,"prototype",{writable:!1,enumerable:!1}),Object.defineProperty(e.prototype,"constructor",{writable:!0,enumerable:!1,configurable:!0,value:e})),xe&&void 0===je.JsonLdProcessor&&(t?Object.defineProperty(je,"JsonLdProcessor",{writable:!0,enumerable:!1,configurable:!0,value:e}):je.JsonLdProcessor=e);var n="function"==typeof setImmediate&&setImmediate,r=n?function(e){n(e)}:function(e){setTimeout(e,0)};"object"==typeof ke&&"function"==typeof ke.nextTick?D.nextTick=ke.nextTick:D.nextTick=r,D.setImmediate=n?r:D.nextTick,D.parseLinkHeader=function(e){for(var t={},n=e.match(/(?:<[^>]*?>|"[^"]*?"|[^,])+/g),r=/\s*<([^>]*?)>\s*(?:;\s*(.*))?/,o=0;o<n.length;++o){var i=n[o].match(r);if(i){for(var a={target:i[1]},l=i[2],s=/(.*?)=(?:(?:"([^"]*?)")|([^"]*?))\s*(?:(?:;\s*)|$)/g;i=s.exec(l);)a[i[1]]=void 0===i[2]?i[3]:i[2];var u=a.rel||"";K(t[u])?t[u].push(a):t[u]=u in t?[t[u],a]:a}}return t},D.RequestQueue=function(){this._requests={}},D.RequestQueue.prototype.wrapLoader=function(e){return this._loader=e,this._usePromise=1===e.length,this.add.bind(this)},D.RequestQueue.prototype.add=function(o,e){var i=this;if(!e&&!i._usePromise)throw new Error("callback must be specified.");if(i._usePromise)return new D.Promise(function(t,n){var e=i._requests[o];e||(e=i._requests[o]=i._loader(o).then(function(e){return delete i._requests[o],e}).catch(function(e){throw delete i._requests[o],e})),e.then(function(e){t(e)}).catch(function(e){n(e)})});o in i._requests?i._requests[o].push(e):(i._requests[o]=[e],i._loader(o,function(e,t){var n=i._requests[o];delete i._requests[o];for(var r=0;r<n.length;++r)n[r](e,t)}))},D.DocumentCache=function(e){this.order=[],this.cache={},this.size=e||50,this.expires=3e4},D.DocumentCache.prototype.get=function(e){if(e in this.cache){var t=this.cache[e];if(t.expires>=+new Date)return t.ctx;delete this.cache[e],this.order.splice(this.order.indexOf(e),1)}return null},D.DocumentCache.prototype.set=function(e,t){this.order.length===this.size&&delete this.cache[this.order.shift()],this.order.push(e),this.cache[e]={ctx:t,expires:+new Date+this.expires}},D.ActiveContextCache=function(e){this.order=[],this.cache={},this.size=e||100},D.ActiveContextCache.prototype.get=function(e,t){var n=JSON.stringify(e),r=JSON.stringify(t),o=this.cache[n];return o&&r in o?o[r]:null},D.ActiveContextCache.prototype.set=function(e,t,n){if(this.order.length===this.size){var r=this.order.shift();delete this.cache[r.activeCtx][r.localCtx]}var o=JSON.stringify(e),i=JSON.stringify(t);this.order.push({activeCtx:o,localCtx:i}),o in this.cache||(this.cache[o]={}),this.cache[o][i]=ue(n)},D.cache={activeCtx:new D.ActiveContextCache},D.documentLoaders={},D.documentLoaders.jquery=function(e,t){t=t||{};var n=new D.RequestQueue;return("usePromise"in t?t.usePromise:"undefined"!=typeof Promise)?n.wrapLoader(function(e){return D.promisify(r,e)}):n.wrapLoader(r);function r(a,l){return 0!==a.indexOf("http:")&&0!==a.indexOf("https:")?l(new O('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:a}),{contextUrl:null,documentUrl:a,document:null}):t.secure&&0!==a.indexOf("https")?l(new O('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:a}),{contextUrl:null,documentUrl:a,document:null}):void e.ajax({url:a,accepts:{json:"application/ld+json, application/json"},headers:{Accept:"application/ld+json, application/json"},dataType:"json",crossDomain:!0,success:function(e,t,n){var r={contextUrl:null,documentUrl:a,document:e},o=n.getResponseHeader("Content-Type"),i=n.getResponseHeader("Link");if(i&&"application/ld+json"!==o){if(K(i=D.parseLinkHeader(i)[p]))return l(new O("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:a}),r);i&&(r.contextUrl=i.target)}l(null,r)},error:function(e,t,n){l(new O("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:a,cause:n}),{contextUrl:null,documentUrl:a,document:null})}})}},D.documentLoaders.node=function(n){var r=!("strictSSL"in(n=n||{}))||n.strictSSL,u="maxRedirects"in n?n.maxRedirects:-1,o="request"in n?n.request:Se("request"),c="application/ld+json, application/json",f=Se("http"),e=new D.RequestQueue;if(n.usePromise)return e.wrapLoader(function(e){return D.promisify(d,e,[])});var t=n.headers||{};if("Accept"in t||"accept"in t)throw new RangeError('Accept header may not be specified as an option; only "'+c+'" is supported.');return e.wrapLoader(function(e,t){d(e,[],t)});function d(i,a,l){if(0!==i.indexOf("http:")&&0!==i.indexOf("https:"))return l(new O('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:i}),{contextUrl:null,documentUrl:i,document:null});if(n.secure&&0!==i.indexOf("https"))return l(new O('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:i}),{contextUrl:null,documentUrl:i,document:null});var s=null;if(null!==s)return l(null,s);var e={Accept:c};for(var t in n.headers)e[t]=n.headers[t];o({url:i,headers:e,strictSSL:r,followRedirect:!1},function(e,t,n){if(s={contextUrl:null,documentUrl:i,document:n||null},e)return l(new O("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:i,cause:e}),s);var r=f.STATUS_CODES[t.statusCode];if(400<=t.statusCode)return l(new O("URL could not be dereferenced: "+r,"jsonld.InvalidUrl",{code:"loading document failed",url:i,httpStatusCode:t.statusCode}),s);if(t.headers.link&&"application/ld+json"!==t.headers["content-type"]){var o=D.parseLinkHeader(t.headers.link)[p];if(K(o))return l(new O("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:i}),s);o&&(s.contextUrl=o.target)}if(300<=t.statusCode&&t.statusCode<400&&t.headers.location)return a.length===u?l(new O("URL could not be dereferenced; there were too many redirects.","jsonld.TooManyRedirects",{code:"loading document failed",url:i,httpStatusCode:t.statusCode,redirects:a}),s):-1!==a.indexOf(i)?l(new O("URL could not be dereferenced; infinite redirection was detected.","jsonld.InfiniteRedirectDetected",{code:"recursive context inclusion",url:i,httpStatusCode:t.statusCode,redirects:a}),s):(a.push(i),d(t.headers.location,a,l));a.push(i),l(e,s)})}},D.documentLoaders.xhr=function(e){e=e||{};var a=/(^|(\r\n))link:/i,t=new D.RequestQueue;return("usePromise"in e?e.usePromise:"undefined"!=typeof Promise)?t.wrapLoader(function(e){return D.promisify(n,e)}):t.wrapLoader(n);function n(r,o){if(0!==r.indexOf("http:")&&0!==r.indexOf("https:"))return o(new O('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:r}),{contextUrl:null,documentUrl:r,document:null});if(e.secure&&0!==r.indexOf("https"))return o(new O('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:r}),{contextUrl:null,documentUrl:r,document:null});var i=new(e.xhr||XMLHttpRequest);i.onload=function(){if(400<=i.status)return o(new O("URL could not be dereferenced: "+i.statusText,"jsonld.LoadDocumentError",{code:"loading document failed",url:r,httpStatusCode:i.status}),{contextUrl:null,documentUrl:r,document:null});var e,t={contextUrl:null,documentUrl:r,document:i.response},n=i.getResponseHeader("Content-Type");if(a.test(i.getAllResponseHeaders())&&(e=i.getResponseHeader("Link")),e&&"application/ld+json"!==n){if(K(e=D.parseLinkHeader(e)[p]))return o(new O("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:r}),t);e&&(t.contextUrl=e.target)}o(null,t)},i.onerror=function(){o(new O("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:r}),{contextUrl:null,documentUrl:r,document:null})},i.open("GET",r,!0),i.setRequestHeader("Accept","application/ld+json, application/json"),i.send()}},D.useDocumentLoader=function(e){if(!(e in D.documentLoaders))throw new O('Unknown document loader type: "'+e+'"',"jsonld.UnknownDocumentLoader",{type:e});D.documentLoader=D.documentLoaders[e].apply(D,Array.prototype.slice.call(arguments,1))},D.processContext=function(n,e){var r={},t=2;3<arguments.length&&(r=arguments[2]||{},t+=1);var o=arguments[t];if("base"in r||(r.base=""),"documentLoader"in r||(r.documentLoader=D.loadDocument),null===e)return o(null,W(r));Q(e=ue(e))&&"@context"in e||(e={"@context":e}),fe(e,r,function(e,t){if(e)return o(e);try{t=(new d).processContext(n,t,r)}catch(e){return o(e)}o(null,t)})},D.hasProperty=function(e,t){var n=!1;if(t in e){var r=e[t];n=!K(r)||0<r.length}return n},D.hasValue=function(e,t,n){var r=!1;if(D.hasProperty(e,t)){var o=e[t],i=ae(o);if(K(o)||i){i&&(o=o["@list"]);for(var a=0;a<o.length;++a)if(D.compareValues(n,o[a])){r=!0;break}}else K(n)||(r=D.compareValues(n,o))}return r},D.addValue=function(e,t,n,r){if("propertyIsArray"in(r=r||{})||(r.propertyIsArray=!1),"allowDuplicate"in r||(r.allowDuplicate=!0),K(n)){0!==n.length||!r.propertyIsArray||t in e||(e[t]=[]);for(var o=0;o<n.length;++o)D.addValue(e,t,n[o],r)}else if(t in e){var i=!r.allowDuplicate&&D.hasValue(e,t,n);K(e[t])||i&&!r.propertyIsArray||(e[t]=[e[t]]),i||e[t].push(n)}else e[t]=r.propertyIsArray?[n]:n},D.getValues=function(e,t){var n=e[t]||[];return K(n)||(n=[n]),n},D.removeProperty=function(e,t){delete e[t]},D.removeValue=function(e,t,n,r){"propertyIsArray"in(r=r||{})||(r.propertyIsArray=!1);var o=D.getValues(e,t).filter(function(e){return!D.compareValues(e,n)});0===o.length?D.removeProperty(e,t):1!==o.length||r.propertyIsArray?e[t]=o:e[t]=o[0]},D.compareValues=function(e,t){return e===t||(!(!ie(e)||!ie(t)||e["@value"]!==t["@value"]||e["@type"]!==t["@type"]||e["@language"]!==t["@language"]||e["@index"]!==t["@index"])||!!(Q(e)&&"@id"in e&&Q(t)&&"@id"in t)&&e["@id"]===t["@id"])},D.getContextValue=function(e,t,n){var r=null;if(null===t)return r;if("@language"===n&&n in e&&(r=e[n]),e.mappings[t]){var o=e.mappings[t];ne(n)?r=o:n in o&&(r=o[n])}return r};var a={};if(D.registerRDFParser=function(e,t){a[e]=t},D.unregisterRDFParser=function(e){delete a[e]},we){if(void 0===v)var v=null;if(void 0===g)var g={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12}}var l="http://www.w3.org/2001/XMLSchema#boolean",s="http://www.w3.org/2001/XMLSchema#double",u="http://www.w3.org/2001/XMLSchema#integer",m="http://www.w3.org/2001/XMLSchema#string",o="http://www.w3.org/1999/02/22-rdf-syntax-ns#",T=o+"first",R=o+"rest",U=o+"nil",$=o+"type",y=o+"PlainLiteral",b=o+"XMLLiteral",w=o+"object",x=o+"langString",p="http://www.w3.org/ns/json-ld#context",h=10,O=function(e,t,n){we?(Error.call(this),Error.captureStackTrace(this,this.constructor)):"undefined"!=typeof Error&&(this.stack=(new Error).stack),this.name=t||"jsonld.Error",this.message=e||"An unspecified JSON-LD error occurred.",this.details=n||{}};we?Se("util").inherits(O,Error):"undefined"!=typeof Error&&(O.prototype=new Error);var d=function(){};function L(e){for(var t=[],n=Object.keys(e).sort(),r=0;r<n.length;++r){var o=n[r],i=e[o];K(i)||(i=[i]);for(var a=0;a<i.length;++a){var l=i[a];if(null!==l){if(!Z(l))throw new O("Invalid JSON-LD syntax; language map values must be strings.","jsonld.SyntaxError",{code:"invalid language map value",languageMap:e});t.push({"@value":l,"@language":o.toLowerCase()})}}}return t}function c(e,t,n){for(var r=[],o=Object.keys(e).sort(),i=0;i<o.length;++i)for(var a=o[i],l=e[a],s=Object.keys(l).sort(),u=0;u<s.length;++u){var c=s[u],f=l[c];if("@type"===c)c=$;else if(X(c))continue;for(var d=0;d<f.length;++d){var p=f[d],h={};if(h.type=0===a.indexOf("_:")?"blank node":"IRI",se(h.value=a)){var v={};if(v.type=0===c.indexOf("_:")?"blank node":"IRI",se(v.value=c)&&("blank node"!==v.type||n.produceGeneralizedRdf))if(ae(p))k(p["@list"],t,h,v,r);else{var g=j(p);g&&r.push({subject:h,predicate:v,object:g})}}}}return r}function k(e,t,n,r,o){for(var i={type:"IRI",value:T},a={type:"IRI",value:R},l={type:"IRI",value:U},s=0;s<e.length;++s){var u=e[s],c={type:"blank node",value:t.getId()};o.push({subject:n,predicate:r,object:c}),n=c,r=i;var f=j(u);f&&o.push({subject:n,predicate:r,object:f}),r=a}o.push({subject:n,predicate:r,object:l})}function j(e){var t,n={};if(ie(e)){n.type="literal";var r=e["@value"],o=e["@type"]||null;"boolean"==typeof(t=r)||"[object Boolean]"===Object.prototype.toString.call(t)?(n.value=r.toString(),n.datatype=o||l):te(r)||o===s?(te(r)||(r=parseFloat(r)),n.value=r.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),n.datatype=o||s):ee(r)?(n.value=r.toFixed(0),n.datatype=o||u):"@language"in e?(n.value=r,n.datatype=o||x,n.language=e["@language"]):(n.value=r,n.datatype=o||m)}else{var i=Q(e)?e["@id"]:e;n.type=0===i.indexOf("_:")?"blank node":"IRI",n.value=i}return"IRI"!==n.type||se(n.value)?n:null}function q(e,t){if("IRI"===e.type||"blank node"===e.type)return{"@id":e.value};var n,r={"@value":e.value};if(e.language)r["@language"]=e.language;else{var o=e.datatype;if(o||(o=m),t){if(o===l)"true"===r["@value"]?r["@value"]=!0:"false"===r["@value"]&&(r["@value"]=!1);else if(n=r["@value"],!isNaN(parseFloat(n))&&isFinite(n))if(o===u){var i=parseInt(r["@value"],10);i.toFixed(0)===r["@value"]&&(r["@value"]=i)}else o===s&&(r["@value"]=parseFloat(r["@value"]));-1===[l,u,s,m].indexOf(o)&&(r["@type"]=o)}else o!==m&&(r["@type"]=o)}return r}function _(e,t){for(var n=["subject","predicate","object"],r=0;r<n.length;++r){var o=n[r];if(e[o].type!==t[o].type||e[o].value!==t[o].value)return!1}return e.object.language===t.object.language&&e.object.datatype===t.object.datatype}d.prototype.compact=function(e,t,n,r){if(K(n)){for(var o=[],i=0;i<n.length;++i){var a=this.compact(e,t,n[i],r);null!==a&&o.push(a)}if(r.compactArrays&&1===o.length)null===(x=D.getContextValue(e,t,"@container"))&&(o=o[0]);return o}if(Q(n)){if(r.link&&"@id"in n&&n["@id"]in r.link){var l=r.link[n["@id"]];for(i=0;i<l.length;++i)if(l[i].expanded===n)return l[i].compacted}if(ie(n)||oe(n)){o=function(e,t,n){if(ie(n)){var r=D.getContextValue(e,t,"@type"),o=D.getContextValue(e,t,"@language"),i=D.getContextValue(e,t,"@container"),a="@index"in n&&"@index"!==i;if(!a&&(n["@type"]===r||n["@language"]===o))return n["@value"];var l=Object.keys(n).length,s=1===l||2===l&&"@index"in n&&!a,u="@language"in e,c=Z(n["@value"]),f=e.mappings[t]&&null===e.mappings[t]["@language"];if(s&&(!u||!c||f))return n["@value"];var d={};return a&&(d[J(e,"@index")]=n["@index"]),"@type"in n?d[J(e,"@type")]=J(e,n["@type"],null,{vocab:!0}):"@language"in n&&(d[J(e,"@language")]=n["@language"]),d[J(e,"@value")]=n["@value"],d}var p=G(e,t,{vocab:!0}),r=D.getContextValue(e,t,"@type"),h=J(e,n["@id"],null,{vocab:"@vocab"===r});if("@id"===r||"@vocab"===r||"@graph"===p)return h;return(d={})[J(e,"@id")]=h,d}(e,t,n);return r.link&&oe(n)&&(n["@id"]in r.link||(r.link[n["@id"]]=[]),r.link[n["@id"]].push({expanded:n,compacted:o})),o}var s="@reverse"===t;o={};r.link&&"@id"in n&&(n["@id"]in r.link||(r.link[n["@id"]]=[]),r.link[n["@id"]].push({expanded:n,compacted:o}));for(var u=Object.keys(n).sort(),c=0;c<u.length;++c){var f=u[c],d=n[f];if("@id"!==f&&"@type"!==f)if("@reverse"!==f)if("@index"!==f)if("@graph"!==f&&"@list"!==f&&X(f)){_=J(e,f);D.addValue(o,_,d)}else{if(0===d.length){var p=J(e,f,d,{vocab:!0},s);D.addValue(o,p,d,{propertyIsArray:!0})}for(I=0;I<d.length;++I){var h=d[I],v=(p=J(e,f,h,{vocab:!0},s),x=D.getContextValue(e,p,"@container"),ae(h)),g=null;v&&(g=h["@list"]);var m=this.compact(e,p,v?g:h,r);if(v)if(K(m)||(m=[m]),"@list"!==x){var y={};y[J(e,"@list")]=m,m=y,"@index"in h&&(m[J(e,"@index")]=h["@index"])}else if(p in o)throw new O('JSON-LD compact error; property has a "@list" @container rule but there is more than a single @list that matches the compacted term in the document. Compaction might mix unwanted items into the list.',"jsonld.SyntaxError",{code:"compaction to list of lists"});if("@language"===x||"@index"===x){var b;p in o?b=o[p]:o[p]=b={},"@language"===x&&ie(m)&&(m=m["@value"]),D.addValue(b,h[x],m)}else{L=!r.compactArrays||"@set"===x||"@list"===x||K(m)&&0===m.length||"@list"===f||"@graph"===f;D.addValue(o,p,m,{propertyIsArray:L})}}}else{if("@index"===(x=D.getContextValue(e,t,"@container")))continue;_=J(e,f);D.addValue(o,_,d)}else{S=this.compact(e,"@reverse",d,r);for(var w in S)if(e.mappings[w]&&e.mappings[w].reverse){var x,k=S[w],j="@set"===(x=D.getContextValue(e,w,"@container"))||!r.compactArrays;D.addValue(o,w,k,{propertyIsArray:j}),delete S[w]}if(0<Object.keys(S).length){var _=J(e,f);D.addValue(o,_,S)}}else{var S;if(Z(d))S=J(e,d,null,{vocab:"@type"===f});else{S=[];for(var I=0;I<d.length;++I)S.push(J(e,d[I],null,{vocab:!0}))}var _=J(e,f),L=K(S)&&0===d.length;D.addValue(o,_,S,{propertyIsArray:L})}}return o}return n},d.prototype.expand=function(s,e,t,u,n){var c=this;if(null==t)return null;if(!K(t)&&!Q(t))return n||null!==e&&"@graph"!==G(s,e,{vocab:!0})?function(e,t,n){if(null==n)return null;var r=G(e,t,{vocab:!0});{if("@id"===r)return G(e,n,{base:!0});if("@type"===r)return G(e,n,{vocab:!0,base:!0})}var o=D.getContextValue(e,t,"@type");if("@id"===o||"@graph"===r&&Z(n))return{"@id":G(e,n,{base:!0})};if("@vocab"===o)return{"@id":G(e,n,{vocab:!0,base:!0})};if(X(r))return n;var i={};if(null!==o)i["@type"]=o;else if(Z(n)){var a=D.getContextValue(e,t,"@language");null!==a&&(i["@language"]=a)}-1===["boolean","number","string"].indexOf(typeof n)&&(n=n.toString());return i["@value"]=n,i}(s,e,t):null;if(K(t)){var r=[],o=D.getContextValue(s,e,"@container");n=n||"@list"===o;for(var i=0;i<t.length;++i){var a=c.expand(s,e,t[i],u);if(n&&(K(a)||ae(a)))throw new O("Invalid JSON-LD syntax; lists of lists are not permitted.","jsonld.SyntaxError",{code:"list of lists"});null!==a&&(K(a)?r=r.concat(a):r.push(a))}return r}"@context"in t&&(s=c.processContext(s,t["@context"],u));for(var l=G(s,e,{vocab:!0}),f=(r={},Object.keys(t).sort()),d=0;d<f.length;++d){var p,h=f[d],v=t[h];if("@context"!==h){var g=G(s,h,{vocab:!0});if(null!==g&&(se(g)||X(g))){if(X(g)){if("@reverse"===l)throw new O("Invalid JSON-LD syntax; a keyword cannot be used as a @reverse property.","jsonld.SyntaxError",{code:"invalid reverse property map",value:v});if(g in r)throw new O("Invalid JSON-LD syntax; colliding keywords detected.","jsonld.SyntaxError",{code:"colliding keywords",keyword:g})}if("@id"===g&&!Z(v)){if(!u.isFrame)throw new O('Invalid JSON-LD syntax; "@id" value must a string.',"jsonld.SyntaxError",{code:"invalid @id value",value:v});if(!Q(v))throw new O('Invalid JSON-LD syntax; "@id" value must be a string or an object.',"jsonld.SyntaxError",{code:"invalid @id value",value:v})}if("@type"===g&&Y(v),"@graph"===g&&!Q(v)&&!K(v))throw new O('Invalid JSON-LD syntax; "@graph" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid @graph value",value:v});if("@value"===g&&(Q(v)||K(v)))throw new O('Invalid JSON-LD syntax; "@value" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid value object value",value:v});if("@language"===g){if(null===v)continue;if(!Z(v))throw new O('Invalid JSON-LD syntax; "@language" value must be a string.',"jsonld.SyntaxError",{code:"invalid language-tagged string",value:v});v=v.toLowerCase()}if("@index"===g&&!Z(v))throw new O('Invalid JSON-LD syntax; "@index" value must be a string.',"jsonld.SyntaxError",{code:"invalid @index value",value:v});if("@reverse"!==g){if("@language"===(o=D.getContextValue(s,h,"@container"))&&Q(v))p=L(v);else if("@index"===o&&Q(v))p=function(e){for(var t=[],n=Object.keys(v).sort(),r=0;r<n.length;++r){var o=n[r],i=v[o];K(i)||(i=[i]),i=c.expand(s,e,i,u,!1);for(var a=0;a<i.length;++a){var l=i[a];"@index"in l||(l["@index"]=o),t.push(l)}}return t}(h);else{var m="@list"===g;if(m||"@set"===g){var y=e;if(m&&"@graph"===l&&(y=null),p=c.expand(s,y,v,u,m),m&&ae(p))throw new O("Invalid JSON-LD syntax; lists of lists are not permitted.","jsonld.SyntaxError",{code:"list of lists"})}else p=c.expand(s,h,v,u,!1)}if(null!==p||"@value"===g)if("@list"===g||ae(p)||"@list"!==o||(p={"@list":p=K(p)?p:[p]}),s.mappings[h]&&s.mappings[h].reverse){x=r["@reverse"]=r["@reverse"]||{};K(p)||(p=[p]);for(j=0;j<p.length;++j){if(ie(_=p[j])||ae(_))throw new O('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:p});D.addValue(x,g,_,{propertyIsArray:!0})}}else{var b=-1===["@index","@id","@type","@value","@language"].indexOf(g);D.addValue(r,g,p,{propertyIsArray:b})}}else{if(!Q(v))throw new O('Invalid JSON-LD syntax; "@reverse" value must be an object.',"jsonld.SyntaxError",{code:"invalid @reverse value",value:v});if("@reverse"in(p=c.expand(s,"@reverse",v,u)))for(var w in p["@reverse"])D.addValue(r,w,p["@reverse"][w],{propertyIsArray:!0});var x=r["@reverse"]||null;for(var w in p)if("@reverse"!==w){null===x&&(x=r["@reverse"]={}),D.addValue(x,w,[],{propertyIsArray:!0});for(var k=p[w],j=0;j<k.length;++j){var _;if(ie(_=k[j])||ae(_))throw new O('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:p});D.addValue(x,w,_,{propertyIsArray:!0})}}}}}}var S=(f=Object.keys(r)).length;if("@value"in r){if("@type"in r&&"@language"in r)throw new O('Invalid JSON-LD syntax; an element containing "@value" may not contain both "@type" and "@language".',"jsonld.SyntaxError",{code:"invalid value object",element:r});var I=S-1;if("@type"in r&&(I-=1),"@index"in r&&(I-=1),"@language"in r&&(I-=1),0!==I)throw new O('Invalid JSON-LD syntax; an element containing "@value" may only have an "@index" property and at most one other property which can be "@type" or "@language".',"jsonld.SyntaxError",{code:"invalid value object",element:r});if(null===r["@value"])r=null;else{if("@language"in r&&!Z(r["@value"]))throw new O("Invalid JSON-LD syntax; only strings may be language-tagged.","jsonld.SyntaxError",{code:"invalid language-tagged value",element:r});if("@type"in r&&(!se(r["@type"])||0===r["@type"].indexOf("_:")))throw new O('Invalid JSON-LD syntax; an element containing "@value" and "@type" must have an absolute IRI for the value of "@type".',"jsonld.SyntaxError",{code:"invalid typed value",element:r})}}else if("@type"in r&&!K(r["@type"]))r["@type"]=[r["@type"]];else if("@set"in r||"@list"in r){if(1<S&&!(2===S&&"@index"in r))throw new O('Invalid JSON-LD syntax; if an element has the property "@set" or "@list", then it can have at most one other property that is "@index".',"jsonld.SyntaxError",{code:"invalid set or list object",element:r});"@set"in r&&(r=r["@set"],S=(f=Object.keys(r)).length)}else 1===S&&"@language"in r&&(r=null);return!Q(r)||u.keepFreeFloatingNodes||n||null!==e&&"@graph"!==l||(0===S||"@value"in r||"@list"in r||1===S&&"@id"in r)&&(r=null),r},d.prototype.createNodeMap=function(e,t){var n={"@default":{}};return E(e,n,"@default",(t=t||{}).namer||t.issuer||new he("_:b")),A(n)},d.prototype.flatten=function(e){for(var t=this.createNodeMap(e),n=[],r=Object.keys(t).sort(),o=0;o<r.length;++o){var i=t[r[o]];oe(i)||n.push(i)}return n},d.prototype.frame=function(e,t,n){var r={options:n,graphs:{"@default":{},"@merged":{}},subjectStack:[],link:{}},o=new he("_:b");E(e,r.graphs,"@merged",o),r.subjects=r.graphs["@merged"];var i=[];return function e(t,n,r,o,i){!function(e){if(!K(e)||1!==e.length||!Q(e[0]))throw new O("Invalid JSON-LD syntax; a JSON-LD frame must be a single object.","jsonld.SyntaxError",{frame:e})}(r);r=r[0];var a=t.options;var l={embed:M(r,a,"embed"),explicit:M(r,a,"explicit"),requireAll:M(r,a,"requireAll")};var s=function(e,t,n,r){for(var o={},i=0;i<t.length;++i){var a=t[i],l=e.subjects[a];F(l,n,r)&&(o[a]=l)}return o}(t,n,r,l);var u=Object.keys(s).sort();for(var c=0;c<u.length;++c){var f=u[c],d=s[f];if("@link"===l.embed&&f in t.link)V(o,i,t.link[f]);else{null===i&&(t.uniqueEmbeds={});var p={};if(p["@id"]=f,t.link[f]=p,"@never"===l.embed||N(d,t.subjectStack))V(o,i,p);else{"@last"===l.embed&&(f in t.uniqueEmbeds&&B(t,f),t.uniqueEmbeds[f]={parent:o,property:i}),t.subjectStack.push(d);for(var h=Object.keys(d).sort(),v=0;v<h.length;v++){var g=h[v];if(X(g))p[g]=ue(d[g]);else if(!l.explicit||g in r)for(var m=d[g],y=0;y<m.length;++y){var b=m[y];if(ae(b)){var w={"@list":[]};V(p,g,w);var x=b["@list"];for(var k in x)if(oe(b=x[k])){var j=g in r?r[g][0]["@list"]:P(l);e(t,[b["@id"]],j,w,"@list")}else V(w,"@list",ue(b))}else if(oe(b)){var j=g in r?r[g]:P(l);e(t,[b["@id"]],j,p,g)}else V(p,g,ue(b))}}for(var h=Object.keys(r).sort(),v=0;v<h.length;++v){var g=h[v];if(!X(g)){var _=r[g][0],S=M(_,a,"omitDefault");if(!(S||g in p)){var I="@null";"@default"in _&&(I=ue(_["@default"])),K(I)||(I=[I]),p[g]=[{"@preserve":I}]}}}V(o,i,p),t.subjectStack.pop()}}}}(r,Object.keys(r.subjects).sort(),t,i,null),i},d.prototype.normalize=function(e,t,n){return"URDNA2015"===t.algorithm?new I(t).main(e,n):"URGNA2012"===t.algorithm?new C(t).main(e,n):void n(new Error("Invalid RDF Dataset Normalization algorithm: "+t.algorithm))},d.prototype.fromRDF=function(e,t,n){var r={},o={"@default":r},i={};for(var a in e){var l=e[a];a in o||(o[a]={}),"@default"===a||a in r||(r[a]={"@id":a});for(var s=o[a],u=0;u<l.length;++u){var c=l[u],f=c.subject.value,d=c.predicate.value,p=c.object;f in s||(s[f]={"@id":f});var h=s[f],v="IRI"===p.type||"blank node"===p.type;if(!v||p.value in s||(s[p.value]={"@id":p.value}),d!==$||t.useRdfType||!v){var g=q(p,t.useNativeTypes);if(D.addValue(h,d,g,{propertyIsArray:!0}),v)if(p.value===U){var m=s[p.value];"usages"in m||(m.usages=[]),m.usages.push({node:h,property:d,value:g})}else p.value in i?i[p.value]=!1:i[p.value]={node:h,property:d,value:g}}else D.addValue(h,"@type",p.value,{propertyIsArray:!0})}}for(var a in o){var y=o[a];if(U in y){for(var b=y[U],w=0;w<b.usages.length;++w){for(var x=b.usages[w],k=(h=x.node,x.property),j=x.value,_=[],S=[],I=Object.keys(h).length;k===R&&Q(i[h["@id"]])&&K(h[T])&&1===h[T].length&&K(h[R])&&1===h[R].length&&(3===I||4===I&&K(h["@type"])&&1===h["@type"].length&&"http://www.w3.org/1999/02/22-rdf-syntax-ns#List"===h["@type"][0])&&(_.push(h[T][0]),S.push(h["@id"]),h=(x=i[h["@id"]]).node,k=x.property,j=x.value,I=Object.keys(h).length,0===h["@id"].indexOf("_:")););if(k===T){if(h["@id"]===U)continue;j=y[j["@id"]][R][0],_.pop(),S.pop()}delete j["@id"],j["@list"]=_.reverse();for(var L=0;L<S.length;++L)delete y[S[L]]}delete b.usages}}var O=[],C=Object.keys(r).sort();for(w=0;w<C.length;++w){var E=C[w];h=r[E];if(E in o){l=h["@graph"]=[],y=o[E];for(var A=Object.keys(y).sort(),P=0;P<A.length;++P){var N=y[A[P]];oe(N)||l.push(N)}}oe(h)||O.push(h)}n(null,O)},d.prototype.toRDF=function(e,t){var n=new he("_:b"),r={"@default":{}};E(e,r,"@default",n);for(var o={},i=Object.keys(r).sort(),a=0;a<i.length;++a){var l=i[a];("@default"===l||se(l))&&(o[l]=c(r[l],n,t))}return o},d.prototype.processContext=function(e,t,n){Q(t)&&"@context"in t&&K(t["@context"])&&(t=t["@context"]);var r=K(t)?t:[t];if(0===r.length)return e.clone();for(var o=e,i=0;i<r.length;++i){var a=r[i];if(null!==a){if(Q(a)&&"@context"in a&&(a=a["@context"]),!Q(a))throw new O("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:a});if(D.cache.activeCtx){var l=D.cache.activeCtx.get(e,a);if(l){o=e=l;continue}}o=(e=o).clone();var s={};if("@base"in a){var u=a["@base"];if(null===u)u=null;else{if(!Z(u))throw new O('Invalid JSON-LD syntax; the value of "@base" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid base IRI",context:a});if(""!==u&&!se(u))throw new O('Invalid JSON-LD syntax; the value of "@base" in a @context must be an absolute IRI or the empty string.',"jsonld.SyntaxError",{code:"invalid base IRI",context:a})}null!==u&&(u=D.url.parse(u||"")),o["@base"]=u,s["@base"]=!0}if("@vocab"in a){if(null===(c=a["@vocab"]))delete o["@vocab"];else{if(!Z(c))throw new O('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:a});if(!se(c))throw new O('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be an absolute IRI.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:a});o["@vocab"]=c}s["@vocab"]=!0}if("@language"in a){var c;if(null===(c=a["@language"]))delete o["@language"];else{if(!Z(c))throw new O('Invalid JSON-LD syntax; the value of "@language" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid default language",context:a});o["@language"]=c.toLowerCase()}s["@language"]=!0}for(var f in a)z(o,a,f,s);D.cache.activeCtx&&D.cache.activeCtx.set(e,a,o)}else o=e=W(n)}return o};var f,i,S,I=(f={subject:"s",object:"o",name:"g"},(i=function(e){e=e||{},this.name="URDNA2015",this.options=e,this.blankNodeInfo={},this.hashToBlankNodes={},this.canonicalIssuer=new he("_:c14n"),this.quads=[],this.schedule={},this.schedule.MAX_DEPTH="maxCallStackDepth"in e?e.maxCallStackDepth:500,this.schedule.MAX_TOTAL_DEPTH="maxTotalCallStackDepth"in e?e.maxCallStackDepth:4294967295,this.schedule.depth=0,this.schedule.totalDepth=0,this.schedule.timeSlice="timeSlice"in e?e.timeSlice:10}).prototype.doWork=function(n,r){var o=this.schedule;if(o.totalDepth>=o.MAX_TOTAL_DEPTH)return r(new Error("Maximum total call stack depth exceeded; normalization aborting."));!function e(){if(o.depth===o.MAX_DEPTH)return o.depth=0,o.running=!1,D.nextTick(e);var t=(new Date).getTime();if(o.running||(o.start=(new Date).getTime(),o.deadline=o.start+o.timeSlice),t<o.deadline)return o.running=!0,o.depth++,o.totalDepth++,n(function(e,t){o.depth--,o.totalDepth--,r(e,t)});o.depth=0,o.running=!1,D.setImmediate(e)}()},i.prototype.forEach=function(e,r,o){var i,t,a=this,n=0;if(K(e))t=e.length,i=function(){return n!==t&&(i.value=e[n++],i.key=n,!0)};else{var l=Object.keys(e);t=l.length,i=function(){return n!==t&&(i.key=l[n++],i.value=e[i.key],!0)}}!function e(t,n){return t?o(t):i()?a.doWork(function(){r(i.value,i.key,e)}):void o()}()},i.prototype.waterfall=function(e,t){var r=this;r.forEach(e,function(e,t,n){r.doWork(e,n)},t)},i.prototype.whilst=function(n,r,o){var i=this;!function e(t){return t?o(t):n()?void i.doWork(r,e):o()}()},i.prototype.main=function(t,n){var o,a=this;if(a.schedule.start=(new Date).getTime(),a.options.format&&"application/nquads"!==a.options.format)return n(new O("Unknown output format.","jsonld.UnknownFormat",{format:a.options.format}));var l={};a.waterfall([function(e){a.forEach(t,function(e,r,t){"@default"===r&&(r=null),a.forEach(e,function(n,e,t){null!==r&&(0===r.indexOf("_:")?n.name={type:"blank node",value:r}:n.name={type:"IRI",value:r}),a.quads.push(n),a.forEachComponent(n,function(e){if("blank node"===e.type){var t=e.value;t in a.blankNodeInfo?a.blankNodeInfo[t].quads.push(n):(l[t]=!0,a.blankNodeInfo[t]={quads:[n]})}}),t()},t)},e)},function(e){var i=!0;a.whilst(function(){return i},function(e){i=!1,a.hashToBlankNodes={},a.waterfall([function(e){a.forEach(l,function(e,n,r){a.hashFirstDegreeQuads(n,function(e,t){if(e)return r(e);t in a.hashToBlankNodes?a.hashToBlankNodes[t].push(n):a.hashToBlankNodes[t]=[n],r()})},e)},function(e){var t=Object.keys(a.hashToBlankNodes).sort();a.forEach(t,function(e,t,n){var r=a.hashToBlankNodes[e];if(1<r.length)return n();var o=r[0];a.canonicalIssuer.getId(o),delete l[o],delete a.hashToBlankNodes[e],i=!0,n()},e)}],e)},e)},function(e){var t=Object.keys(a.hashToBlankNodes).sort();a.forEach(t,function(e,t,n){var o=[],r=a.hashToBlankNodes[e];a.waterfall([function(e){a.forEach(r,function(e,t,n){if(a.canonicalIssuer.hasId(e))return n();var r=new he("_:b");r.getId(e),a.hashNDegreeQuads(e,r,function(e,t){if(e)return n(e);o.push(t),n()})},e)},function(e){o.sort(function(e,t){return e.hash<t.hash?-1:e.hash>t.hash?1:0}),a.forEach(o,function(e,t,n){for(var r in e.issuer.existing)a.canonicalIssuer.getId(r);n()},e)}],n)},e)},function(e){var r=[];a.waterfall([function(e){a.forEach(a.quads,function(e,t,n){a.forEachComponent(e,function(e){"blank node"===e.type&&0!==e.value.indexOf(a.canonicalIssuer.prefix)&&(e.value=a.canonicalIssuer.getId(e.value))}),r.push(pe(e)),n()},e)},function(e){if(r.sort(),"application/nquads"===a.options.format)return o=r.join(""),e();o=de(r.join("")),e()}],e)}],function(e){n(e,o)})},i.prototype.hashFirstDegreeQuads=function(o,t){var i=this,n=i.blankNodeInfo[o];if("hash"in n)return t(null,n.hash);var a=[],e=n.quads;i.forEach(e,function(e,t,n){var r={predicate:e.predicate};i.forEachComponent(e,function(e,t){r[t]=i.modifyFirstDegreeComponent(o,e,t)}),a.push(pe(r)),n()},function(e){if(e)return t(e);a.sort(),n.hash=ge.hashNQuads(i.name,a),t(null,n.hash)})},i.prototype.modifyFirstDegreeComponent=function(e,t){return"blank node"!==t.type||((t=ue(t)).value=t.value===e?"_:a":"_:z"),t},i.prototype.hashRelatedBlankNode=function(e,n,t,r,o){var i,a=this;a.waterfall([function(n){return a.canonicalIssuer.hasId(e)?(i=a.canonicalIssuer.getId(e),n()):t.hasId(e)?(i=t.getId(e),n()):void a.hashFirstDegreeQuads(e,function(e,t){if(e)return n(e);i=t,n()})}],function(e){if(e)return o(e);var t=new ge(a.name);return t.update(r),"g"!==r&&t.update(a.getRelatedPredicate(n)),t.update(i),o(null,t.digest())})},i.prototype.getRelatedPredicate=function(e){return"<"+e.predicate.value+">"},i.prototype.hashNDegreeQuads=function(e,c,t){var r,f=this,o=new ge(f.name);f.waterfall([function(n){f.createHashToRelated(e,c,function(e,t){if(e)return n(e);r=t,n()})},function(e){var t=Object.keys(r).sort();f.forEach(t,function(e,t,n){o.update(e);var l,s="",u=new ve(r[e]);f.whilst(function(){return u.hasNext()},function(o){var t=u.next(),i=c.clone(),a="",r=[];f.waterfall([function(e){f.forEach(t,function(e,t,n){if(f.canonicalIssuer.hasId(e)?a+=f.canonicalIssuer.getId(e):(i.hasId(e)||r.push(e),a+=i.getId(e)),0!==s.length&&a.length>=s.length&&s<a)return o();n()},e)},function(e){f.forEach(r,function(n,e,r){f.hashNDegreeQuads(n,i,function(e,t){return e?r(e):(a+=i.getId(n),a+="<"+t.hash+">",i=t.issuer,0!==s.length&&a.length>=s.length&&s<a?o():void r())})},e)},function(e){(0===s.length||a<s)&&(s=a,l=i),e()}],o)},function(e){if(e)return n(e);o.update(s),c=l,n()})},e)}],function(e){t(e,{hash:o.digest(),issuer:c})})},i.prototype.createHashToRelated=function(a,l,t){var s=this,u={},e=s.blankNodeInfo[a].quads;s.forEach(e,function(i,e,t){s.forEach(i,function(e,t,n){if("predicate"===t||"blank node"!==e.type||e.value===a)return n();var r=e.value,o=f[t];s.hashRelatedBlankNode(r,i,l,o,function(e,t){if(e)return n(e);t in u?u[t].push(r):u[t]=[r],n()})},t)},function(e){t(e,u)})},i.prototype.forEachComponent=function(e,t){for(var n in e)"predicate"!==n&&t(e[n],n,e)},i),C=(((S=function(e){I.call(this,e),this.name="URGNA2012"}).prototype=new I).modifyFirstDegreeComponent=function(e,t,n){return"blank node"!==t.type||((t=ue(t)).value="name"===n?"_:g":t.value===e?"_:a":"_:z"),t},S.prototype.getRelatedPredicate=function(e){return e.predicate.value},S.prototype.createHashToRelated=function(i,a,t){var l=this,s={},e=l.blankNodeInfo[i].quads;l.forEach(e,function(e,t,n){var r,o;if("blank node"===e.subject.type&&e.subject.value!==i)o=e.subject.value,r="p";else{if("blank node"!==e.object.type||e.object.value===i)return n();o=e.object.value,r="r"}l.hashRelatedBlankNode(o,e,a,r,function(e,t){t in s?s[t].push(o):s[t]=[o],n()})},function(e){t(e,s)})},S);function E(e,t,n,r,o,i){if(K(e))for(var a=0;a<e.length;++a)E(e[a],t,n,r,void 0,i);else if(Q(e))if(ie(e)){"@type"in e&&0===(s=e["@type"]).indexOf("_:")&&(e["@type"]=s=r.getId(s)),i&&i.push(e)}else{if("@type"in e){var l=e["@type"];for(a=0;a<l.length;++a){var s;0===(s=l[a]).indexOf("_:")&&r.getId(s)}}ne(o)&&(o=le(e)?r.getId(e["@id"]):e["@id"]),i&&i.push({"@id":o});var u=t[n],c=u[o]=u[o]||{};c["@id"]=o;for(var f=Object.keys(e).sort(),d=0;d<f.length;++d){var p=f[d];if("@id"!==p)if("@reverse"!==p)if("@graph"!==p)if("@type"!==p&&X(p)){if("@index"===p&&p in c&&(e[p]!==c[p]||e[p]["@id"]!==c[p]["@id"]))throw new O("Invalid JSON-LD syntax; conflicting @index property detected.","jsonld.SyntaxError",{code:"conflicting indexes",subject:c});c[p]=e[p]}else{var h=e[p];if(0===p.indexOf("_:")&&(p=r.getId(p)),0!==h.length)for(var v=0;v<h.length;++v){var g=h[v];if("@type"===p&&(g=0===g.indexOf("_:")?r.getId(g):g),re(g)||oe(g)){var m=le(g)?r.getId(g["@id"]):g["@id"];D.addValue(c,p,{"@id":m},{propertyIsArray:!0,allowDuplicate:!1}),E(g,t,n,r,m)}else if(ae(g)){var y=[];E(g["@list"],t,n,r,o,y),g={"@list":y},D.addValue(c,p,g,{propertyIsArray:!0,allowDuplicate:!1})}else E(g,t,n,r,o),D.addValue(c,p,g,{propertyIsArray:!0,allowDuplicate:!1})}else D.addValue(c,p,[],{propertyIsArray:!0})}else{o in t||(t[o]={});var b="@merged"===n?n:o;E(e[p],t,b,r)}else{var w={"@id":o},x=e["@reverse"];for(var k in x)for(var j=x[k],_=0;_<j.length;++_){var S=j[_],I=S["@id"];le(S)&&(I=r.getId(I)),E(S,t,n,r,I),D.addValue(u[I],k,w,{propertyIsArray:!0,allowDuplicate:!1})}}}}else i&&i.push(e)}function A(e){for(var t=e["@default"],n=Object.keys(e).sort(),r=0;r<n.length;++r){var o=n[r];if("@default"!==o){var i=e[o],a=t[o];a?"@graph"in a||(a["@graph"]=[]):t[o]=a={"@id":o,"@graph":[]};for(var l=a["@graph"],s=Object.keys(i).sort(),u=0;u<s.length;++u){var c=i[s[u]];oe(c)||l.push(c)}}}return t}function P(e){var t={};for(var n in e)void 0!==e[n]&&(t["@"+n]=[e[n]]);return[t]}function N(e,t){for(var n=t.length-1;0<=n;--n)if(t[n]["@id"]===e["@id"])return!0;return!1}function M(e,t,n){var r="@"+n,o=r in e?e[r][0]:t[n];return"embed"===n&&(!0===o?o="@last":!1===o?o="@never":"@always"!==o&&"@never"!==o&&"@link"!==o&&(o="@last")),o}function F(e,t,n){if("@type"in t&&(1!==t["@type"].length||!Q(t["@type"][0]))){for(var r=t["@type"],o=0;o<r.length;++o)if(D.hasValue(e,"@type",r[o]))return!0;return!1}var i=!0,a=!1;for(var l in t){if(X(l)){if("@id"!==l&&"@type"!==l)continue;if(i=!1,"@id"===l&&Z(t[l])){if(e[l]!==t[l])return!1;a=!0;continue}}if(i=!1,l in e){if(K(t[l])&&0===t[l].length&&void 0!==e[l])return!1;a=!0}else{var s=K(t[l])&&Q(t[l][0])&&"@default"in t[l][0];if(n.requireAll&&!s)return!1}}return i||a}function B(e,t){var o=e.uniqueEmbeds,n=o[t],r=n.parent,i=n.property,a={"@id":t};if(K(r)){for(var l=0;l<r.length;++l)if(D.compareValues(r[l],a)){r[l]=a;break}}else{var s=K(r[i]);D.removeValue(r,i,a,{propertyIsArray:s}),D.addValue(r,i,a,{propertyIsArray:s})}var u=function(e){for(var t=Object.keys(o),n=0;n<t.length;++n){var r=t[n];r in o&&Q(o[r].parent)&&o[r].parent["@id"]===e&&(delete o[r],u(r))}};u(t)}function V(e,t,n){Q(e)?D.addValue(e,t,n,{propertyIsArray:!0}):e.push(n)}function H(e,t){return e.length<t.length?-1:t.length<e.length?1:e===t?0:e<t?-1:1}function J(e,t,n,r,o){if(null===t)return t;ne(n)&&(n=null),ne(o)&&(o=!1),r=r||{};var i=e.getInverse();if(X(t))return t in i?i[t]["@none"]["@type"]["@none"]:t;if(r.vocab&&t in i){var a=e["@language"]||"@none",l=[];Q(n)&&"@index"in n&&l.push("@index");var s="@language",u="@null";if(o)s="@type",u="@reverse",l.push("@set");else if(ae(n)){"@index"in n||l.push("@list");for(var c=n["@list"],f=0===c.length?a:null,d=null,p=0;p<c.length;++p){var h=c[p],v="@none",g="@none";if(ie(h)?"@language"in h?v=h["@language"]:"@type"in h?g=h["@type"]:v="@null":g="@id",null===f?f=v:v!==f&&ie(h)&&(f="@none"),null===d?d=g:g!==d&&(d="@none"),"@none"===f&&"@none"===d)break}f=f||"@none","@none"!==(d=d||"@none")?(s="@type",u=d):u=f}else ie(n)?"@language"in n&&!("@index"in n)?(l.push("@language"),u=n["@language"]):"@type"in n&&(u=n[s="@type"]):(s="@type",u="@id"),l.push("@set");l.push("@none");var m=function(e,t,n,r,o,i){null===i&&(i="@null");var a=[];if("@id"!==i&&"@reverse"!==i||!oe(n))a.push(i);else{"@reverse"===i&&a.push("@reverse");var l=J(e,n["@id"],null,{vocab:!0});l in e.mappings&&e.mappings[l]&&e.mappings[l]["@id"]===n["@id"]?a.push.apply(a,["@vocab","@id"]):a.push.apply(a,["@id","@vocab"])}a.push("@none");for(var s=e.inverse[t],u=0;u<r.length;++u){var c=r[u];if(c in s)for(var f=s[c][o],d=0;d<a.length;++d){var p=a[d];if(p in f)return f[p]}}return null}(e,t,n,l,s,u);if(null!==m)return m}if(r.vocab&&"@vocab"in e){var y=e["@vocab"];if(0===t.indexOf(y)&&t!==y){var b=t.substr(y.length);if(!(b in e.mappings))return b}}for(var w=null,x=0,k=[],j=e.fastCurieMap,_=t.length-1;x<_&&t[x]in j;++x)""in(j=j[t[x]])&&k.push(j[""][0]);for(p=k.length-1;0<=p;--p)for(var S=k[p],I=S.terms,L=0;L<I.length;++L){var O=I[L]+":"+t.substr(S.iri.length);(!(O in e.mappings)||null===n&&e.mappings[O]["@id"]===t)&&(null===w||H(O,w)<0)&&(w=O)}return null!==w?w:r.vocab?t:function(e,t){if(null===e)return t;Z(e)&&(e=D.url.parse(e||""));var n="";""!==e.href?n+=(e.protocol||"")+"//"+(e.authority||""):t.indexOf("//")&&(n+="//");if(0!==t.indexOf(n))return t;var r=D.url.parse(t.substr(n.length)),o=e.normalizedPath.split("/"),i=r.normalizedPath.split("/"),a=r.fragment||r.query?0:1;for(;0<o.length&&i.length>a&&o[0]===i[0];)o.shift(),i.shift();var l="";if(0<o.length){o.pop();for(var s=0;s<o.length;++s)l+="../"}l+=i.join("/"),null!==r.query&&(l+="?"+r.query);null!==r.fragment&&(l+="#"+r.fragment);""===l&&(l="./");return l}(e["@base"],t)}function z(e,t,n,r){if(n in r){if(r[n])return;throw new O("Cyclical context definition detected.","jsonld.CyclicalContext",{code:"cyclic IRI mapping",context:t,term:n})}if(r[n]=!1,X(n))throw new O("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:t,term:n});if(""===n)throw new O("Invalid JSON-LD syntax; a term cannot be an empty string.","jsonld.SyntaxError",{code:"invalid term definition",context:t});e.mappings[n]&&delete e.mappings[n];var o=t[n];if(null===o||Q(o)&&null===o["@id"])return e.mappings[n]=null,void(r[n]=!0);if(Z(o)&&(o={"@id":o}),!Q(o))throw new O("Invalid JSON-LD syntax; @context property values must be strings or objects.","jsonld.SyntaxError",{code:"invalid term definition",context:t});var i=e.mappings[n]={};if(i.reverse=!1,"@reverse"in o){if("@id"in o)throw new O("Invalid JSON-LD syntax; a @reverse term definition must not contain @id.","jsonld.SyntaxError",{code:"invalid reverse property",context:t});var a=o["@reverse"];if(!Z(a))throw new O("Invalid JSON-LD syntax; a @context @reverse value must be a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});if(!se(l=G(e,a,{vocab:!0,base:!1},t,r)))throw new O("Invalid JSON-LD syntax; a @context @reverse value must be an absolute IRI or a blank node identifier.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});i["@id"]=l,i.reverse=!0}else if("@id"in o){if(!Z(l=o["@id"]))throw new O("Invalid JSON-LD syntax; a @context @id value must be an array of strings or a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});if(l!==n){if(!se(l=G(e,l,{vocab:!0,base:!1},t,r))&&!X(l))throw new O("Invalid JSON-LD syntax; a @context @id value must be an absolute IRI, a blank node identifier, or a keyword.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});i["@id"]=l}}var l,s=n.indexOf(":");if(i._termHasColon=-1!==s,!("@id"in i))if(i._termHasColon){var u=n.substr(0,s);if(u in t&&z(e,t,u,r),e.mappings[u]){var c=n.substr(s+1);i["@id"]=e.mappings[u]["@id"]+c}else i["@id"]=n}else{if(!("@vocab"in e))throw new O("Invalid JSON-LD syntax; @context terms must define an @id.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t,term:n});i["@id"]=e["@vocab"]+n}if(r[n]=!0,"@type"in o){var f=o["@type"];if(!Z(f))throw new O("Invalid JSON-LD syntax; an @context @type values must be a string.","jsonld.SyntaxError",{code:"invalid type mapping",context:t});if("@id"!==f&&"@vocab"!==f){if(!se(f=G(e,f,{vocab:!0,base:!1},t,r)))throw new O("Invalid JSON-LD syntax; an @context @type value must be an absolute IRI.","jsonld.SyntaxError",{code:"invalid type mapping",context:t});if(0===f.indexOf("_:"))throw new O("Invalid JSON-LD syntax; an @context @type values must be an IRI, not a blank node identifier.","jsonld.SyntaxError",{code:"invalid type mapping",context:t})}i["@type"]=f}if("@container"in o){var d=o["@container"];if("@list"!==d&&"@set"!==d&&"@index"!==d&&"@language"!==d)throw new O("Invalid JSON-LD syntax; @context @container value must be one of the following: @list, @set, @index, or @language.","jsonld.SyntaxError",{code:"invalid container mapping",context:t});if(i.reverse&&"@index"!==d&&"@set"!==d&&null!==d)throw new O("Invalid JSON-LD syntax; @context @container value for a @reverse type definition must be @index or @set.","jsonld.SyntaxError",{code:"invalid reverse property",context:t});i["@container"]=d}if("@language"in o&&!("@type"in o)){var p=o["@language"];if(null!==p&&!Z(p))throw new O("Invalid JSON-LD syntax; @context @language value must be a string or null.","jsonld.SyntaxError",{code:"invalid language mapping",context:t});null!==p&&(p=p.toLowerCase()),i["@language"]=p}if("@context"===(l=i["@id"])||"@preserve"===l)throw new O("Invalid JSON-LD syntax; @context and @preserve cannot be aliased.","jsonld.SyntaxError",{code:"invalid keyword alias",context:t})}function G(e,t,n,r,o){if(null===t||X(t))return t;if(t=String(t),r&&t in r&&!0!==o[t]&&z(e,r,t,o),(n=n||{}).vocab){if(null===(a=e.mappings[t]))return null;if(a)return a["@id"]}var i=t.indexOf(":");if(-1!==i){var a,l=t.substr(0,i),s=t.substr(i+1);return"_"===l||0===s.indexOf("//")?t:(r&&l in r&&z(e,r,l,o),(a=e.mappings[l])?a["@id"]+s:t)}if(n.vocab&&"@vocab"in e)return e["@vocab"]+t;var u=t;return n.base&&(u=D.prependBase(e["@base"],u)),u}function W(e){return{"@base":D.url.parse(e.base||""),mappings:{},inverse:null,getInverse:function(){var e=this;if(e.inverse)return e.inverse;for(var t=e.inverse={},n=e.fastCurieMap={},r={},o=e["@language"]||"@none",i=e.mappings,a=Object.keys(i).sort(H),l=0;l<a.length;++l){var s=a[l],u=i[s];if(null!==u){var c=u["@container"]||"@none",f=u["@id"];K(f)||(f=[f]);for(var d=0;d<f.length;++d){var p=f[d],h=t[p],v=X(p);if(h)v||u._termHasColon||r[p].push(s);else if(t[p]=h={},!v&&!u._termHasColon){r[p]=[s];var g={iri:p,terms:r[p]};p[0]in n?n[p[0]].push(g):n[p[0]]=[g]}if(h[c]||(h[c]={"@language":{},"@type":{}}),h=h[c],u.reverse)w(u,s,h["@type"],"@reverse");else if("@type"in u)w(u,s,h["@type"],u["@type"]);else if("@language"in u){var m=u["@language"]||"@null";w(u,s,h["@language"],m)}else w(u,s,h["@language"],o),w(u,s,h["@type"],"@none"),w(u,s,h["@language"],"@none")}}}for(var y in n)b(n,y,1);return t},clone:function(){var e={};e["@base"]=this["@base"],e.mappings=ue(this.mappings),e.clone=this.clone,e.inverse=null,e.getInverse=this.getInverse,"@language"in this&&(e["@language"]=this["@language"]);"@vocab"in this&&(e["@vocab"]=this["@vocab"]);return e}};function b(e,t,n){for(var r,o,i=e[t],a=e[t]={},l=0;l<i.length;++l)(o=n>=(r=i[l].iri).length?"":r[n])in a?a[o].push(i[l]):a[o]=[i[l]];for(var t in a)""!==t&&b(a,t,n+1)}function w(e,t,n,r){r in n||(n[r]=t)}}function X(e){if(!Z(e))return!1;switch(e){case"@base":case"@context":case"@container":case"@default":case"@embed":case"@explicit":case"@graph":case"@id":case"@index":case"@language":case"@list":case"@omitDefault":case"@preserve":case"@requireAll":case"@reverse":case"@set":case"@type":case"@value":case"@vocab":return!0}return!1}function Q(e){return"[object Object]"===Object.prototype.toString.call(e)}function K(e){return Array.isArray(e)}function Y(e){if(!Z(e)&&(!Q(t=e)||0!==Object.keys(t).length)){var t,n=!1;if(K(e)){n=!0;for(var r=0;r<e.length;++r)if(!Z(e[r])){n=!1;break}}if(!n)throw new O('Invalid JSON-LD syntax; "@type" value must a string, an array of strings, or an empty object.',"jsonld.SyntaxError",{code:"invalid type value",value:e})}}function Z(e){return"string"==typeof e||"[object String]"===Object.prototype.toString.call(e)}function ee(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function te(e){return ee(e)&&-1!==String(e).indexOf(".")}function ne(e){return void 0===e}function re(e){var t=!1;Q(e)&&!("@value"in e||"@set"in e||"@list"in e)&&(t=1<Object.keys(e).length||!("@id"in e));return t}function oe(e){return Q(e)&&1===Object.keys(e).length&&"@id"in e}function ie(e){return Q(e)&&"@value"in e}function ae(e){return Q(e)&&"@list"in e}function le(e){var t=!1;return Q(e)&&(t="@id"in e?0===e["@id"].indexOf("_:"):0===Object.keys(e).length||!("@value"in e||"@set"in e||"@list"in e)),t}function se(e){return Z(e)&&-1!==e.indexOf(":")}function ue(e){if(e&&"object"==typeof e){var t;if(K(e)){t=[];for(var n=0;n<e.length;++n)t[n]=ue(e[n])}else if(Q(e))for(var r in t={},e)t[r]=ue(e[r]);else t=e.toString();return t}return e}function ce(e,t,n,r){var o=Object.keys(t).length;if(K(e)){for(var i=0;i<e.length;++i)ce(e[i],t,n,r);return o<Object.keys(t).length}if(Q(e)){for(var a in e)if("@context"===a){var l=e[a];if(K(l)){var s=l.length;for(i=0;i<s;++i){var u=l[i];Z(u)&&(u=D.prependBase(r,u),n?K(u=t[u])?(Array.prototype.splice.apply(l,[i,1].concat(u)),i+=u.length-1,s=l.length):l[i]=u:u in t||(t[u]=!1))}}else Z(l)&&(l=D.prependBase(r,l),n?e[a]=t[l]:l in t||(t[l]=!1))}else ce(e[a],t,n,r);return o<Object.keys(t).length}return!1}function fe(e,t,n){var f=null,r=t.documentLoader,d=function(e,n,i,t,a){if(Object.keys(n).length>h)return f=new O("Maximum number of @context URLs exceeded.","jsonld.ContextUrlError",{code:"loading remote context failed",max:h}),a(f);var l={},s=function(){ce(e,l,!0,t),a(null,e)};if(!ce(e,l,!1,t))return s();var r=[];for(var o in l)!1===l[o]&&r.push(o);for(var u=r.length,c=0;c<r.length;++c)!function(r){if(r in n)return f=new O("Cyclical @context URLs detected.","jsonld.ContextUrlError",{code:"recursive context inclusion",url:r}),a(f);var o=ue(n);o[r]=!0;var e=function(t,e){if(!f){var n=e?e.document:null;if(!t&&Z(n))try{n=JSON.parse(n)}catch(e){t=e}if(t?t=new O("Dereferencing a URL did not result in a valid JSON-LD object. Possible causes are an inaccessible URL perhaps due to a same-origin policy (ensure the server uses CORS if you are using client-side JavaScript), too many redirects, a non-JSON response, or more than one HTTP Link Header was provided for a remote context.","jsonld.InvalidUrl",{code:"loading remote context failed",url:r,cause:t}):Q(n)||(t=new O("Dereferencing a URL did not result in a JSON object. The response was valid JSON, but it was not a JSON object.","jsonld.InvalidUrl",{code:"invalid remote context",url:r,cause:t})),t)return a(f=t);n="@context"in n?{"@context":n["@context"]}:{"@context":{}},e.contextUrl&&(K(n["@context"])||(n["@context"]=[n["@context"]]),n["@context"].push(e.contextUrl)),d(n,o,i,r,function(e,t){if(e)return a(e);l[r]=t["@context"],0===(u-=1)&&s()})}},t=i(r,e);t&&"then"in t&&t.then(e.bind(null,null),e)}(r[c])};d(e,{},r,t.base,n)}function de(e){for(var t="(?:#.*)?",n="[ \\t]*",r=new RegExp("^"+n+t+"$"),o=new RegExp("^"+n+'(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z0-9]+)))[ \\t]+(?:<([^:]+:[^>]*)>)[ \\t]+(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z0-9]+))|(?:"([^"\\\\]*(?:\\\\.[^"\\\\]*)*)"(?:(?:\\^\\^(?:<([^:]+:[^>]*)>))|(?:@([a-z]+(?:-[a-z0-9]+)*)))?))[ \\t]*(?:\\.|(?:(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z0-9]+)))[ \\t]*\\.))'+n+t+"$"),i={},a=e.split(/(?:\r\n)|(?:\n)|(?:\r)/g),l=0,s=0;s<a.length;++s){var u=a[s];if(l++,!r.test(u)){var c=u.match(o);if(null===c)throw new O("Error while parsing N-Quads; invalid quad.","jsonld.ParseError",{line:l});var f={};if(ne(c[1])?f.subject={type:"blank node",value:c[2]}:f.subject={type:"IRI",value:c[1]},f.predicate={type:"IRI",value:c[3]},ne(c[4]))if(ne(c[5])){f.object={type:"literal"},ne(c[7])?ne(c[8])?f.object.datatype=m:(f.object.datatype=x,f.object.language=c[8]):f.object.datatype=c[7];var d=c[6].replace(/\\"/g,'"').replace(/\\t/g,"\t").replace(/\\n/g,"\n").replace(/\\r/g,"\r").replace(/\\\\/g,"\\");f.object.value=d}else f.object={type:"blank node",value:c[5]};else f.object={type:"IRI",value:c[4]};var p="@default";if(ne(c[9])?ne(c[10])||(p=c[10]):p=c[9],p in i){for(var h=!0,v=i[p],g=0;h&&g<v.length;++g)_(v[g],f)&&(h=!1);h&&v.push(f)}else i[p]=[f]}}return i}function pe(e,t){var n=e.subject,r=e.predicate,o=e.object,i=t||null;"name"in e&&e.name&&(i=e.name.value);var a="";if("IRI"===n.type?a+="<"+n.value+">":a+=n.value,a+=" ","IRI"===r.type?a+="<"+r.value+">":a+=r.value,a+=" ","IRI"===o.type)a+="<"+o.value+">";else if("blank node"===o.type)a+=o.value;else{a+='"'+o.value.replace(/\\/g,"\\\\").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\"/g,'\\"')+'"',o.datatype===x?o.language&&(a+="@"+o.language):o.datatype!==m&&(a+="^^<"+o.datatype+">")}return null!=i&&(0!==i.indexOf("_:")?a+=" <"+i+">":a+=" "+i),a+=" .\n"}function he(e){this.prefix=e,this.counter=0,this.existing={}}Object.keys||(Object.keys=function(e){if(e!==Object(e))throw new TypeError("Object.keys called on non-object");var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}),D.registerRDFParser("application/nquads",de),D.registerRDFParser("rdfa-api",function(e){for(var t={"@default":[]},n=e.getSubjects(),r=0;r<n.length;++r){var o=n[r];if(null!==o){var i=e.getSubjectTriples(o);if(null!==i){var a=i.predicates;for(var l in a)for(var s=a[l].objects,u=0;u<s.length;++u){var c=s[u],f={};0===o.indexOf("_:")?f.subject={type:"blank node",value:o}:f.subject={type:"IRI",value:o},0===l.indexOf("_:")?f.predicate={type:"blank node",value:l}:f.predicate={type:"IRI",value:l};var d=c.value;if(c.type===b){v||me();var p=new v;d="";for(var h=0;h<c.value.length;h++)c.value[h].nodeType===g.ELEMENT_NODE?d+=p.serializeToString(c.value[h]):c.value[h].nodeType===g.TEXT_NODE&&(d+=c.value[h].nodeValue)}f.object={},c.type===w?0===c.value.indexOf("_:")?f.object.type="blank node":f.object.type="IRI":(f.object.type="literal",c.type===y?c.language?(f.object.datatype=x,f.object.language=c.language):f.object.datatype=m:f.object.datatype=c.type),f.object.value=d,t["@default"].push(f)}}}}return t}),D.IdentifierIssuer=he,(D.UniqueNamer=he).prototype.clone=function(){var e=new he(this.prefix);return e.counter=this.counter,e.existing=ue(this.existing),e},he.prototype.getId=function(e){if(e&&e in this.existing)return this.existing[e];var t=this.prefix+this.counter;return this.counter+=1,e&&(this.existing[e]=t),t},he.prototype.getName=he.prototype.getName,he.prototype.isNamed=he.prototype.hasId=function(e){return e in this.existing};var ve=function(e){this.list=e.sort(),this.done=!1,this.left={};for(var t=0;t<e.length;++t)this.left[e[t]]=!0};ve.prototype.hasNext=function(){return!this.done},ve.prototype.next=function(){for(var e=this.list.slice(),t=null,n=0,r=this.list.length,o=0;o<r;++o){var i=this.list[o],a=this.left[i];(null===t||t<i)&&(a&&0<o&&i>this.list[o-1]||!a&&o<r-1&&i>this.list[o+1])&&(t=i,n=o)}if(null===t)this.done=!0;else{var l=this.left[t]?n-1:n+1;this.list[n]=this.list[l],this.list[l]=t;for(o=0;o<r;++o)this.list[o]>t&&(this.left[this.list[o]]=!this.left[this.list[o]])}return e};var ge=function(e){if(!(this instanceof ge))return new ge(e);if(-1===["URDNA2015","URGNA2012"].indexOf(e))throw new Error("Invalid RDF Dataset Normalization algorithm: "+e);ge._init.call(this,e)};if(ge.hashNQuads=function(e,t){for(var n=new ge(e),r=0;r<t.length;++r)n.update(t[r]);return n.digest()},function(e){if(we){var t=Se("crypto");return ge._init=function(e){e="URDNA2015"===e?"sha256":"sha1",this.md=t.createHash(e)},ge.prototype.update=function(e){return this.md.update(e,"utf8")},ge.prototype.digest=function(){return this.md.digest("hex")}}ge._init=function(e){e="URDNA2015"===e?new y.Algorithm:new f.Algorithm,this.md=new a(e)},ge.prototype.update=function(e){return this.md.update(e)},ge.prototype.digest=function(){return this.md.digest().toHex()};var a=function(e){if(!(this instanceof a))return new a(e);if(this._algorithm=e,!a._padding||a._padding.length<this._algorithm.blockSize){a._padding=String.fromCharCode(128);for(var t=String.fromCharCode(0),n=64;0<n;)1&n&&(a._padding+=t),0<(n>>>=1)&&(t+=t)}this.start()};a.prototype.start=function(){this.messageLength=0,this.fullMessageLength=[];for(var e=this._algorithm.messageLengthSize/4,t=0;t<e;++t)this.fullMessageLength.push(0);return this._input=new a.ByteBuffer,this.state=this._algorithm.start(),this},a.prototype.update=function(e){e=new a.ByteBuffer(unescape(encodeURIComponent(e))),this.messageLength+=e.length();var t=e.length();t=[t/4294967296>>>0,t>>>0];for(var n=this.fullMessageLength.length-1;0<=n;--n)this.fullMessageLength[n]+=t[1],t[1]=t[0]+(this.fullMessageLength[n]/4294967296>>>0),this.fullMessageLength[n]=this.fullMessageLength[n]>>>0,t[0]=t[1]/4294967296>>>0;for(this._input.putBytes(e.bytes());this._input.length()>=this._algorithm.blockSize;)this.state=this._algorithm.digest(this.state,this._input);return(2048<this._input.read||0===this._input.length())&&this._input.compact(),this},a.prototype.digest=function(){var e=new a.ByteBuffer;e.putBytes(this._input.bytes());var t=this.fullMessageLength[this.fullMessageLength.length-1]+this._algorithm.messageLengthSize&this._algorithm.blockSize-1;e.putBytes(a._padding.substr(0,this._algorithm.blockSize-t));for(var n=new a.ByteBuffer,r=0;r<this.fullMessageLength.length;++r)n.putInt32(this.fullMessageLength[r]<<3|this.fullMessageLength[r+1]>>>28);this._algorithm.writeMessageLength(e,n);var o=this._algorithm.digest(this.state.copy(),e),i=new a.ByteBuffer;return o.write(i),i},a.ByteBuffer=function(e){this.data="string"==typeof e?e:"",this.read=0},a.ByteBuffer.prototype.putInt32=function(e){this.data+=String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e)},a.ByteBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e},a.ByteBuffer.prototype.putBytes=function(e){this.data+=e},a.ByteBuffer.prototype.bytes=function(){return this.data.slice(this.read)},a.ByteBuffer.prototype.length=function(){return this.data.length-this.read},a.ByteBuffer.prototype.compact=function(){this.data=this.data.slice(this.read),this.read=0},a.ByteBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var n=this.data.charCodeAt(t);n<16&&(e+="0"),e+=n.toString(16)}return e};var f={_w:null,Algorithm:function(){this.name="sha1",this.blockSize=64,this.digestLength=20,this.messageLengthSize=8}};f.Algorithm.prototype.start=function(){return f._w||(f._w=new Array(80)),f._createState()},f.Algorithm.prototype.writeMessageLength=function(e,t){e.putBytes(t.bytes())},f.Algorithm.prototype.digest=function(e,t){for(var n,r,o,i,a,l,s,u=t.length(),c=f._w;64<=u;){for(r=e.h0,o=e.h1,i=e.h2,a=e.h3,l=e.h4,s=0;s<16;++s)n=t.getInt32(),n=(r<<5|r>>>27)+(a^o&(i^a))+l+1518500249+(c[s]=n),l=a,a=i,i=o<<30|o>>>2,o=r,r=n;for(;s<20;++s)n=(n=c[s-3]^c[s-8]^c[s-14]^c[s-16])<<1|n>>>31,n=(r<<5|r>>>27)+(a^o&(i^a))+l+1518500249+(c[s]=n),l=a,a=i,i=o<<30|o>>>2,o=r,r=n;for(;s<32;++s)n=(n=c[s-3]^c[s-8]^c[s-14]^c[s-16])<<1|n>>>31,n=(r<<5|r>>>27)+(o^i^a)+l+1859775393+(c[s]=n),l=a,a=i,i=o<<30|o>>>2,o=r,r=n;for(;s<40;++s)n=(n=c[s-6]^c[s-16]^c[s-28]^c[s-32])<<2|n>>>30,n=(r<<5|r>>>27)+(o^i^a)+l+1859775393+(c[s]=n),l=a,a=i,i=o<<30|o>>>2,o=r,r=n;for(;s<60;++s)n=(n=c[s-6]^c[s-16]^c[s-28]^c[s-32])<<2|n>>>30,n=(r<<5|r>>>27)+(o&i|a&(o^i))+l+2400959708+(c[s]=n),l=a,a=i,i=o<<30|o>>>2,o=r,r=n;for(;s<80;++s)n=(n=c[s-6]^c[s-16]^c[s-28]^c[s-32])<<2|n>>>30,n=(r<<5|r>>>27)+(o^i^a)+l+3395469782+(c[s]=n),l=a,a=i,i=o<<30|o>>>2,o=r,r=n;e.h0=e.h0+r|0,e.h1=e.h1+o|0,e.h2=e.h2+i|0,e.h3=e.h3+a|0,e.h4=e.h4+l|0,u-=64}return e},f._createState=function(){var t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520,copy:function(){var e=f._createState();return e.h0=t.h0,e.h1=t.h1,e.h2=t.h2,e.h3=t.h3,e.h4=t.h4,e},write:function(e){e.putInt32(t.h0),e.putInt32(t.h1),e.putInt32(t.h2),e.putInt32(t.h3),e.putInt32(t.h4)}};return t};var y={_k:null,_w:null,Algorithm:function(){this.name="sha256",this.blockSize=64,this.digestLength=32,this.messageLengthSize=8}};y.Algorithm.prototype.start=function(){return y._k||y._init(),y._createState()},y.Algorithm.prototype.writeMessageLength=function(e,t){e.putBytes(t.bytes())},y.Algorithm.prototype.digest=function(e,t){for(var n,r,o,i,a,l,s,u,c,f,d,p,h,v=t.length(),g=y._k,m=y._w;64<=v;){for(a=0;a<16;++a)m[a]=t.getInt32();for(;a<64;++a)n=((n=m[a-2])>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,r=((r=m[a-15])>>>7|r<<25)^(r>>>18|r<<14)^r>>>3,m[a]=n+m[a-7]+r+m[a-16]|0;for(l=e.h0,s=e.h1,u=e.h2,c=e.h3,f=e.h4,d=e.h5,p=e.h6,h=e.h7,a=0;a<64;++a)o=(l>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10),i=l&s|u&(l^s),n=h+((f>>>6|f<<26)^(f>>>11|f<<21)^(f>>>25|f<<7))+(p^f&(d^p))+g[a]+m[a],h=p,p=d,d=f,f=c+n|0,c=u,u=s,s=l,l=n+(r=o+i)|0;e.h0=e.h0+l|0,e.h1=e.h1+s|0,e.h2=e.h2+u|0,e.h3=e.h3+c|0,e.h4=e.h4+f|0,e.h5=e.h5+d|0,e.h6=e.h6+p|0,e.h7=e.h7+h|0,v-=64}return e},y._createState=function(){var t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225,copy:function(){var e=y._createState();return e.h0=t.h0,e.h1=t.h1,e.h2=t.h2,e.h3=t.h3,e.h4=t.h4,e.h5=t.h5,e.h6=t.h6,e.h7=t.h7,e},write:function(e){e.putInt32(t.h0),e.putInt32(t.h1),e.putInt32(t.h2),e.putInt32(t.h3),e.putInt32(t.h4),e.putInt32(t.h5),e.putInt32(t.h6),e.putInt32(t.h7)}};return t},y._init=function(){y._k=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],y._w=new Array(64)}}(),!v)var me=function(){v=Se("xmldom").XMLSerializer};function ye(e,t){var n="";0===e.indexOf("/")&&(n="/");for(var r=e.split("/"),o=[];0<r.length;)"."===r[0]||""===r[0]&&1<r.length?r.shift():".."!==r[0]?o.push(r.shift()):(r.shift(),t||0<o.length&&".."!==o[o.length-1]?o.pop():o.push(".."));return n+o.join("/")}if(D.url={},D.url.parsers={simple:{keys:["href","scheme","authority","path","query","fragment"],regex:/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/},full:{keys:["href","protocol","scheme","authority","auth","user","password","hostname","port","path","directory","file","query","fragment"],regex:/^(([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?(?:(((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/}},D.url.parse=function(e,t){for(var n={},r=D.url.parsers[t||"full"],o=r.regex.exec(e),i=r.keys.length;i--;)n[r.keys[i]]=void 0===o[i]?null:o[i];return n.normalizedPath=ye(n.path,!!n.authority),n},we?D.useDocumentLoader("node"):"undefined"!=typeof XMLHttpRequest&&D.useDocumentLoader("xhr"),we){D.use=function(e){switch(e){case"request":D.request=Se("jsonld-request");break;default:throw new O("Unknown extension.","jsonld.UnknownExtension",{extension:e})}};var be={exports:{},filename:_e};Se("pkginfo")(be,"version"),D.version=be.exports.version}return D},t=function(){return e(function(){return t()})};!we&&"function"==typeof define&&define.amd?define([],function(){return e(t),t}):(e(t),"function"==typeof Se&&void 0!==n&&n.exports&&(n.exports=t),xe&&("undefined"==typeof jsonld?jsonld=jsonldjs=t:jsonldjs=t))}()}).call(this,Se("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},"/primo-explore/custom/ANK/node_modules/jsonld/js")},{_process:1,crypto:29,"es6-promise":28,http:29,"jsonld-request":29,pkginfo:29,request:29,util:29,xmldom:29}]},{},[11]);
//# sourceMappingURL=custom.js.map
